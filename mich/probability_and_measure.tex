\documentclass{article}

\def\npart {II}
\def\nyear {2017}
\def\nterm {Michaelmas}
\def\nlecturer{E.\ Brieuillard}
\def\ncourse{Probability and Measure}
\input{header}
% efjb2@cam.ac.uk

% preamble
\usepackage{bbm}
\setcounter{section}{-1}
\newcommand{\1}[1]{\mathbbm{1}_{#1}}
% and here we go!

\begin{document}
\maketitle
\section{Introduction}
\subsection{Course structure}
\begin{itemize}
    \item Week 1: Lebesgue measure
    \item Week 2: Abstract measure theory
    \item Week 3: Integration
    \item Week 4: Foundations of probability theory
    \item Week 5: $L^p$ spaces
    \item Week 6: Modes of convergence
    \item Week 7: Fourier transform and gaussians
    \item Week 8: Ergodic Theory
\end{itemize}

\subsection{Historical motivation}
Suppose we have a subset $E \subset \R^d$.
\begin{enumerate}
    \item What does it mean to measure this subset?

        In one dimension, we have some intuition of length, and in two and three dimensions we are familiar with the notions of surface area and volume.
    \item Does it make sense to measure every subset?

        This seems reasonable, but it turns out that assigning a measure to every subset can lead to logical contradictions.
    \item What is a measure? It should be a function defined on subsets, in particular some assignment $E \to m(E) \in \R$.
        It should satisfy some properties:
        \begin{itemize}
            \item Non-negativity: $m(E) \geq 0$ for all $E$
            \item Empty set: $m(\emptyset) = 0$
            \item Additivity: $m(E \sqcup F) = m(E) + m(F)$ for any two disjoint sets $E$ and $F$
            \item Normalisation: $m([0, 1]^d) = 1$
            \item Translation invariant: $m(E + x) = m(E)$ for all $E$ and all $x \in \R^d$
        \end{itemize}
        It's possible to construct pathological `measures' satisfying all these axioms and defined \emph{on all} subsets of $\R^d$, but they won't be `nice'.
        When mathematicians construct such measures, they usually do so on a restricted class of sets, otherwise this leads to contradictions.

        If $d \geq 3$, it can be shown that there is no $m: P(\R^d) \to [0, \infty)$ that is also rotation invariant.
        This is referred to as the Hausdorff--Banach--Tarski paradox.
        Namely, if we take $B = B(0, 1) = \Set{\vec{x} \in \R^d: x_1^2 + \dots x_d^2 \leq 1}$, then there is a partition
        \begin{equation*}
            B = X_1 \sqcup \dots \sqcup X_k \sqcup Y_1 \sqcup \dots \sqcup Y_k
        \end{equation*}
        and isometries $g_1, \dotsc, g_k$, $h_1, \dotsc, h_k$ such that
        \begin{equation*}
            \bigcup g_i X_i = B = \bigcup h_i Y_i
        \end{equation*}

    \item Jordan measure

        Consider a box $B \subset \R^d$, given by $B = \prod_{i=1}^d I_i$, where $I_i = [a_i, b_i]$ are intervals in $\R$
        From here, we can define the Jordan measure of the box by $m(B) \coloneqq \prod_{i=1}^d |b_i - a_i|$.
\end{enumerate}

\begin{defi}\hypertarget{def:elemSubs}
    An \textbf{elementary subset} of $\R^d$ is a finite union of boxes.
\end{defi}

\begin{remark}
    Every elementary set can be written as a finite union of disjoint boxes.
    The family of elementary sets is stable under finite unions, finite intersections and set difference.
    The concern may arise that if the disjoint union can be taken in two different ways, then perhaps we could get different measures, but
    \begin{align*}
        E = \bigsqcup_{i=1}^N B_i &= \bigsqcup_{j=1}^M B'_j \\
        \implies \sum_{i=1}^N m(B_i) &= \sum_{j=1}^M m(B'_j)
    \end{align*}

    This means that \emph{makes sense} to define $m(E)$ as $\sum_1^N m(B_i)$, for elementary subsets.
\end{remark}

\begin{defi}\hypertarget{def:jMeasurable}
    A subset $E \subset \R^d$ is \textbf{Jordan measurable} if $\forall \epsilon > 0 \; \exists$ \hyperlink{def:elemSubs}{elementary sets} $A, B$ such that $A \subset E \subset B$ and $m(B\setminus A) < \epsilon$.
\end{defi}

\begin{remark}
    If $E$ is Jordan measurable, then
    \begin{equation*}
        \inf\Set{m(B)| E \subset B, B \,\; \text{elementary}} = \sup\Set{m(A)| A \subset E, A \;\, \text{elementary}}
    \end{equation*}
    Proof is left as an exercise for the reader.
\end{remark}

\begin{defi}\hypertarget{def:jMeasure}
    We define the \textbf{Jordan measure} of $E$ as this supremum or infimum, and denote it by $m(E)$.
\end{defi}

\begin{exercise}
    $m$ so defined satisfies all the axioms defined earlier.
\end{exercise}

\begin{defi}[Riemann integrable function\hypertarget{def:riemannIntegrable}]
    A function $f:[a, b] \to \R$ is \textbf{Riemann integrable} if all its Riemann sums converge.
    Formally, the integral $I(f) \in \R$ exists if $\forall \epsilon > 0$, we can find $\delta > 0$ such that for every partition $P$ of $[a, b]$ of width $\tau(P) < \delta$, we have $\abs{S(f, P) - I(f)} < \epsilon$, where we recall the following

    A partition $P$ given by $a = t_0 < t_1 < \dots < t_n = b$ has width
    \begin{equation*}
        \tau(P) = \max_{0 \leq i < N} \abs{t_{i+1} - t_i}
    \end{equation*}
    and
    \begin{equation*}
        S(f, P) = \sum_{i=1}^{N-1} f(x_i) (t_{i+1} - t_i)
    \end{equation*}
    where $x_i \in [t_i, t_{i+1}]$
\end{defi}

\begin{prop}
    $f$ is Riemann integrable if and only if
    \begin{align*}
        E^+ &= \set{(x, t) \in \R^2 | 0 \leq t \leq f(x)} \\
        E^- &= \set{(x, t) \in \R^2 | f(x) \leq t \leq 0}
    \end{align*}
    are both Jordan measurable.
\end{prop}

However the \hyperlink{def:jMeasure}{Jordan measure} is not perfect. For instance, the complement of a \hyperlink{def:jMeasurable}{Jordan measurable} set is not Jordan measurable.
Also, we can take an (infinite) union of Jordan measurable sets and produce a set which is not Jordan measurable.
In addition, there are simple sets that are not Jordan measurable, and simple functions that are not \hyperlink{def:riemannIntegrable}{Riemann integrable}.

\begin{eg}
    \leavevmode
    \begin{enumerate}[label=(\emph{\roman*})]
        \item
            \begin{equation*}
                \1{\Q}(x) = \begin{cases}
                    1 & x \in \Q \\
                    0 & \text{otherwise}
                \end{cases}
             \end{equation*}
            This is not Riemann integrable, as seen in earlier Analysis courses.
        \item $\Q$ or even $\Q \cap [0, 1]$ is not a Jordan measurable subset of $\R$.
            In fact no dense countable subset of an interval in $\R$ can be Jordan measurable.
    \end{enumerate}
\end{eg}

Another problem is with limits of functions: a pointwise limit of \hyperlink{def:riemannIntegrable}{Riemann integrable} functions is not always Riemann integrable.
\begin{eg}
    $f_n(x) = \1{\frac1{n!}\Z \cap [0, 1]}$ is Riemann integrable, but $f(x) = \lim_{n \to 0} f_n(x) = \1{\Q \cap [0, 1]}$ is not.
\end{eg}

In comparison to the \hyperlink{def:jMeasure}{Jordan measure}, the ideas of Lebesgue were to remove the containment $A \subset E$, and to allow a countable union of boxes instead of just a finite union.
\begin{defi}[\hypertarget{def:lebMAble}{Lebesgue measurable subset}]
    A set $E \subseteq A$ is called \textbf{Lebesgue measurable} if $\forall \epsilon > 0$ there are a countable family of boxes $(B_i)_{i \geq 1}$ such that $E \subseteq \bigcup_{i \geq 1} B_i$ and $m^* (\bigcup B_i \setminus E) < \epsilon$
\end{defi}

Here, we use $m^*$, the \emph{Lebesgue outer measure}, defined as follows.
\begin{equation*}
    m^*(F) = \inf\Set{\sum_{n \geq 1} m(B_n) | F \subset \bigcup_{n \geq 1} B_n, \; B_n \; \text{are boxes}}
\end{equation*}

This is defined for all subsets of $\R^d$, but it is not additive on all subsets.
\begin{remark}
    \leavevmode
    \begin{itemize}
        \item If you let $m^{*, J}(F)$ be defined similarly, but for finitely many boxes $B_n$ instead of countably many (the Jordan outer measure), then $m^*(F) \leq m^{*, J}(F)$.
        \item But the inequality can be strict, for instance for $F = \Q \cap [0, 1]$ we have $m^*(F) = 0$ but $m^{*, J}(F) = 1$.
    \end{itemize}
\end{remark}
This outer measure satisfies
\begin{enumerate}
    \item $m^*(\emptyset) = 0$
    \item $m^*(E) \leq m^*(F)$ if $E \subseteq F$ (monotone)
    \item $m^*\left(\bigcup_{i \geq 1} E_i\right) \leq \sum_{i \geq 1} m^* (E_i)$ (countable subadditivity)
\end{enumerate}

\begin{eg}[Vitali's example]
    Let $E$ be a set of representations of the cosets of the subgroup $(\Q, +) \subset (\R, +)$. We can choose $E \subset [0, 1]$, such that
    \begin{equation*}
        \forall x \in \R \; \exists! e \in E \; \text{such that} \; x - e \in \Q
    \end{equation*}
    So the family $\{E + r\}_{r \in \Q}$ is a disjoint family of subsets of $\R$, a partition.
    By translational invariance, \begin{equation*}m^*(E + r) = m^*(E) \quad \forall r \in \Q\end{equation*}

    If $m^*$ were additive, we can consider distinct $r_1, \dotsc, r_N \in \Q \cap [0, 1]$ so
    \begin{equation*}
        m^*\left(\bigcup_{i=1}^N E + r_i\right) = N m^*(E)
    \end{equation*}
    but
    \begin{align*}
        \bigcup_{i=1}^N E + r_i &\subseteq [0, 2] \\
        \implies m^*\left(\bigcup E + r_i\right) &\leq m^*([0, 2]) \leq 2
    \end{align*}
    So for any $N \in \N$, we have $N m^*(E) \leq 2$, hence $m^*(E) = 0$.
    But $[0, 1] \subseteq \bigcup_{r \in \Q} E + r$, so by countable subadditivity $m^*([0, 1]) \leq \sum_{r \in \Q} m^*(E + r) = 0$ but $m^*([0, 1]) = 1$, so we have a contradiction.
    This shows that $m^*$ is not additive on all subsets.
\end{eg}

\begin{remark} \leavevmode
    \begin{itemize}
        \item This contruction uses the axiom of choice to define $E$.
        \item We will soon define the Lebesgue measure of a \hyperlink{def:lebMAble}{Lebesgue measurable set} as the outer measure of that set, and this will be additive on Lebesgue measurable sets.  This means Vitali's set $E$ was \emph{not} Lebesgue measurable.
    \end{itemize}
\end{remark}

\begin{eg} [Middle-thirds Cantor set]
    It is a compact subset $C$ of $[0, 1]$.  Start with the interval $I_0 = [0, 1]$ and remove the middle third $\left(\frac13, \frac23\right)$, leaving $I_1 = \left[0, \frac13\right] \cup \left[\frac23, 1\right]$.
    Then remove the middle third of each interval here, giving $I_2 = \left[0, \frac19\right] \cup \left[\frac29, \frac13\right] \cup \left[\frac23, \frac79\right] \cup \left[\frac89, 1\right]$.
    Repeat, then define $C = \bigcap_{n \geq 0} I_n$.
    Equivalently, take a ternary expansion of $x \in [0, 1]$, and define $C$ as the set of $x$ which has \emph{none} of its digits equal to $2$.
\end{eg}

\begin{remark}
    $I_n$ is a finite union of intervals, so it is an elementary set (link). In particular, $m(I_n) = 2^n / 3^n \to 0$, as $n \to \infty$ so $C$ is Jordan measurable with measure $0$.
    Every Jordan measurable set is Lebesgue measurable (clear from the definition).
\end{remark}

We can define a `fat' Cantor set which is Jordan measurable but not Lebesgue measurable.

\begin{remark}
    What is the outer measure of a Vitali set?
    $m^*(E) > 0$ by the argument given above, but we can create $E \subseteq [0, \frac1n]$, or inside any interval. So, $m^*(E)$ depends on the choice of $E$ and could be arbitrarily small, but must be positive.
\end{remark}

\begin{remark}
    In the definition of the Lebesgue outer measure, we used closed boxes, but open or half-open boxes would not change the definition. (same for Lebesgue)
\end{remark}

\begin{defi}[\hypertarget{def:lMeasure}{Leb}]
    $E \subseteq \R^d$ is \textbf{Lebesgue measurable} if $\forall \epsilon > 0$, $\exists C \coloneqq \bigcap_{n} B_n$, a countable union of boxes such that $m^*(C \setminus E) < \epsilon$ and $E \subseteq C$.
\end{defi}

\begin{remark}
    Every null set is \hyperlink{def:lebMAble}{lebesgue measurable}.
\end{remark}

\begin{defi}
    A \textbf{null set} $E \subseteq \R^d$ is a subset $E$ such that $m^*(E) = 0$.
\end{defi}

% prop 1
\begin{prop}
    The family $\mathcal{L}$ of Lebesgue measurable subsets of $\R^d$ is stable under
    \begin{enumerate}[label=\alph*)]
        \item countable unions: if $E_n \in \mathcal{L}$ for all $n \in \N$, then $\bigcup_{n \geq 1} E_n \in \mathcal{L}$.
        \item complementation: if $E \in \mathcal{L}$, then $E^c \in \mathcal{L}$.
        \item countable intersections: if $E_n \in \mathcal{L}$ for all $n \in \N$, then $\bigcap_{n \geq 1} E_n \in \mathcal{L}$.
    \end{enumerate}
\end{prop}

% prop 2
\begin{prop}
    Every closed (open) subset of $\R^d$ is Lebesgue measurable.
\end{prop}

\begin{proof} % of prop 1
    First note part c) follows from parts a) and b), since $(\bigcap_n E_n)^c = \bigcup_n E_n^c$. We'll first show a).
    Let $(E_n)_{n \geq 1}$ be a countable family in $\mathcal{L}$, and pick $\epsilon > 0$.  By definition, $\exists C_n \coloneqq \bigcup_{i \geq 1} B_i^{(n)}$ such that $m^*(C_n \setminus E_n) < \frac{\epsilon}{2^n}$.
    Then $\bigcup E_n \subseteq \bigcup C_n = \bigcup_{n, i} B_i^{(n)}$ is still a countable union of boxes.

    Finally,
    \begin{align*}
        m^*\left(\bigcup B_i^{(n)} \setminus \bigcup E_n\right) \leq \sum_n m^*(C_n \setminus E_n) \leq \sum_{n \geq 1} \frac{\epsilon}{2^n} \leq \epsilon
    \end{align*}
    by countable subadditivity of $m^*$, proving a).

    For b), We start with $E \in \mathcal{L}$.  By definition, $\forall n$, there is a $C_n$ countable family of boxes with $E \subseteq C_n$ and $m^* (C_n \setminus E) < \frac1n$.

    Taking complements, we see $C_n^c \subseteq E^c$ and $C_n \setminus E = E^c \setminus C_n^c$.  We take $C_n$ a union of \textit{open boxes}, then $C_n$ is open and $C_n^c$ is closed.

    By (Prop 2), $C_n^c$ is Lebesgue measurable, and by part a) of Prop 1, so is $\bigcup_n C_n^c$. But $\bigcup_n C_n^c \subseteq E^c$ and $m^*(E^c \setminus \bigcup_i C_n^c) \leq m^*(E^c \setminus C_n^c) = m^* (C_n \setminus E) < \frac1n$.

    Hence $m^* (E^c \setminus \bigcup_n C_n^c) = 0$, so
    \begin{equation*}
        E^c = \underbrace{\bigcup_n C_n^c}_{\in \mathcal{L}} \cup \underbrace{E^c \setminus \bigcup_n C_n^c}_{\text{is null hence is in} \; \mathcal{L}}
    \end{equation*}
    so by a) $E \in \mathcal{L}$.

    This shows Prop 1.b modulo prop 2
\end{proof}

\begin{lemma}
    Every open subset of $\R^d$ is a countable union of open boxes.
\end{lemma}

\begin{proof}
    For $r \in \Q_{\geq 0}$ and $s \in \Q^d$, let $B_{s, r} = \set{x \in \R^d | \abs{x_i - s_i} \frac1r \ \text{for} \ i=1,\dotsc,d}$
    $(B_{s,r})_{s,r}$ form a countable family and any open set $U \subseteq \R^d$ is the union of those $B_{s,n}$'s it contains.
\end{proof}

\begin{proof} % of prop 2
    By point a) of Prop 1, we get that every open set in $\R^d$ is Lebesgue measurable. Now, let's show that closed sets are Lebesgue measurable.

    It's enough to show that \emph{compact} subsets of $R^d$ are in $\mathcal{L}$ because every closed subset $F \subseteq \R^d$ is a countable union of compact sets:
    Observe $\R^d = \bigcup_{n \geq 1} A_n$, where $A_n = \text{annulus} = \set{x \in \R^d \mid n-1 \leq \norm{x} \leq n}$, so $F = \bigcup_{n \geq 1} (A_n \cap F)$, and $A_n \cap F$ is compact.

    So, let $F \subseteq \R^d$ be a compact subset. By definition of $m^*(F)$, $\forall k \geq 1$, $\exists \bigcup_n B_n^{(k)}$ a countable union of open boxes such that $F \subseteq \bigcup_n B_n^{(k)}$ and $m^*(F) + \frac{1}{2^k} \geq \sum_n m(B_n^{(k)})$.

    Note: Up to subdividing each $B_n^{(k)}$ into a finite number of smaller boxes, we can assume that each $B_n^{(k)}$ has diameter less than $\frac{1}{2^k}$.
    Without loss of generality we can assume that each box meets $F$.
    Finally, since $F$ is compact, there is a finite subcover, ie I can assume that there are only finite many boxes at each step, ie $F \subseteq \bigcup_{n=1}^{N_k} B_n^{(k)}$ for $N_k \in \N$.

    Let $U_k = \bigcup_{n=1}^{N_k} B_n^{(k)}$, $F \subseteq U_k$ for all $K$ and $F$ meets each box $B_n^{(k)}$ then we must have $F = \bigcap_{k \geq 1} U_k$ (because if $x \in \bigcap U_k$, $\forall k$, $\exists x_k \in F$, $x$ and $x_k$ lie in the same box $B_n^{(k)}$ so $\norm{x - x_k}_\infty \geq \frac1{2^k}$.  $F$ is compact, and $x_k \in F$ has a limit point, so $x \in F$.)

    We need to show that $m^*(U_k \setminus F)$ tends to $0$, because this implies that $F$ is Lebesgue measurable.

    Claim: If $A, B$ are two disjoint compact subsets of $\R^d$ then $m^*(A \cup B) = m^*(A) + m^*(B)$. Proof: Clear from definition as we can choose disjoint covers by open boxes.

    Apply this to $A = F$ and $B = \overline{U_k} \setminus U_{k+1}$ to get $m^*(\overline{U_k} \setminus U_{k+1}) + m^*(F) \leq m^*(\overline{U_k} \setminus U_{k+1} \cup F) \leq m^*(\overline{U_k}) = m^*(U_k) \leq m^*(F) + \frac1{2^k}$, so $m^*(U_{k+1} \setminus U_k) \leq \frac12 k$
    Since $F = \bigcap_k U_k$ by countable subadditivity of $m^*$, you get
    \begin{align}
        m^*(U_k \setminus F) \leq \sum_{i \geq k} m^*
    \end{align}
\end{proof}
\end{document}
