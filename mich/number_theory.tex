\documentclass{article}

\def\npart {II}
\def\nyear {2017}
\def\nterm {Michaelmas}
\def\nlecturer{Prof. A. Scholl}
\def\ncourse{Number Theory}
\input{header}

% preamble
\setcounter{section}{-1}
% and here we go!

\begin{document}
\maketitle
\section{Introduction}
Number theory is concerned with the (non-obvious, sometimes mysterious) properties of the integers, $\Z = \{0, \pm 1, \pm 2, \dots\}$ and the rationals, $\Q = \{\frac{m}{n} \mid m, n \in \Z, n \ne 0\}$.
It has been around for thousands of years, and has always been an experimental science where one can conduct experiments with numbers to spot their properties. Experimental data leads to conjectures which can turn out to be very hard to prove, for instance:
\begin{enumerate}
    \item Congruent number problem: Let $N \geq 1$ be an integer of the form $8n + 5$, $8n+6$ or $8n + 7$.
        Does there exist a right-angled triangle with sides of rational length, and area equal to $N$?
    \item Twin prime conjecture: Does there exist infinitely many primes $p$ such that $p+2$ is also prime?
        Very recently, we know there are infinitely many primes $p$ such that $\{p+2, p+4, \dots, p+246\}$ contains a prime.
    \item $\pi(x)$ refers to the prime counting function, the number of prime numbers $p \leq x$.
        The prime number theorem says that $\pi(x) \sim \mathrm{li}(x) \coloneqq \int_2^x \frac{dt}{\log t}$.
        t is not known whether or not $\abs{\pi(x) - \mathrm{li}(x)} \leq \sqrt{x} \log(x)$, which is equivalent to the Riemann hypothesis - a statement about a certain complex analytic function.
\end{enumerate}
Problem 1 follows from the Birch-Swinnerton-Dyer conjecture, related to algebraic geometry.
Often these proofs can require sophisticated theorems, well beyond the statement of the problem.
\clearpage

\section{Euclid's algorithm and factoring}
\begin{defi}[\hypertarget{def:divisionAlg}Division algorithm]
    Given $a, b \in \Z$, with $b > 0$, there are $q, r \in \Z$ with $0 \leq r < b$ and $a = b q + r$, that is, we can divide $a$ by $b$ to give a quotient $q$ and remainder $r$.
\end{defi}

\begin{proof}
    Let $S = \set{a - n b \mid n \in \Z}$, which certainly contains some non-negative integers. Let $r$ be the least of them  which exists by the well ordering property of the non-negative integers.  Claim $r < b$, since if not then $r - b \in S$, and $r - b \geq 0$, contradicting the choice of $r$.
\end{proof}

\begin{notation}
    If $r = 0$ (that is, $a = bq$ for some $q \in \Z$), write $b \mid a$ (read as `$b$ divides $a$'), otherwise write $b \nmid a$.
\end{notation}

Given $a_1, \dots, a_n \in \Z$ not all zero, let
\begin{equation*}
    I = \{\lambda_1 a_1 + \dots + \lambda_n a_n \mid \lambda_i \in \Z\}
\end{equation*}

We recognise this from GRM as the ideal generated by $\{a_1, \dots, a_n\}$.
Note if $a, b \in I$, for any choice $l, m \in \Z$ then $l a + m b \in I$.

\begin{nlemma}\label{lem:pid_lemma}
    $I = d \Z = \{\lambda d \mid \lambda \in \Z\}$ for some $d \leq 1$, clearly unique.
\end{nlemma}

\begin{proof}
    As not all of $a_i$ are $0$, $I$ contains some positive integer, let $d$ be the least of them.  So, $d \in I$, and hence $d \Z \subset I$.
    On the other hand, for $a \in I$ the \hyperref{def:divisionAlg}{division algorithm} gives us $a = qd + r$ with $0 \leq r < d$. But then $r = a - dq \in I$ so by minimality of $d$ we have $r = 0$, and so $a \in d \Z$, giving $I \subset d \Z$ as required.
\end{proof}

\begin{defi}[\hypertarget{def:gcd}Greatest common divisor]
    $a_i \in I = d \Z$ so $d \mid a_i$.
    If in addition, we have that $\forall i, \, e \mid a_i$, then $e$ divides every element of $I$, so $e \mid d$.
    Write $d = \gcd(a_1, \dots, a_n) = (a_1, \dots, a_n)$, the \textbf{greatest common divisor} (alternatively the highest common factor).
\end{defi}

The study of \textbf{Diophantine equations} involves solving equations with integer solutions, and may have more variables than equations.  The simplest case is is linear in two variables, and can be solved easily.
\begin{cor}
    Let $a, b, c \in \Z$ with not both $a, b$ equal to $0$.  Then we can find $x, y \in \Z$ such that ${a x + by = c \Leftrightarrow (a, b) \mid c}$.
\end{cor}
The definition of the greatest common divisor given here is non-constructive, but \textbf{Euclid's algorithm} is an efficient way to compute it.

\paragraph{Euclid's algorithm}
Assume $a > b > 0$. Apply successively the \hyperlink{def:divisionAlg}{division algorithm}:
\begin{align*}
    a &= q_1 b + r_1 & 0 \leq r_1 < b\\
    b &= q_2 r_1 + r_2 & 0 \leq r_2 < b\\
    r_1 &= q_3 r_2 + r_3 & 0 \leq r_3 < b\\
    \vdots \\
    r_{k-2} &= q_k r_{k-1} + r_k & 0 \leq r_k < b\\
    r_{k-1} &= q_{k+1} r_k + 0
\end{align*}
for some $k$, so $r_k \mid r_{k-1}$
We claim $r_k = (a, b)$. Indeed, $(a, b) = (a - q_1 b, b) = (b, r_1) = (r_1, r_2) = \dots = (r_{k-1}, r_k) = r_k$.
\begin{remark}
     By lemma \ref{lem:pid_lemma}, $(a, b) = r a + s b$ for some integers $r, s$. Euclid's algorithm gives such $r, s$.
\end{remark}

Recall that if $n > 1$ then $n$ is \textbf{prime} if its only positive divisors are $\{1, \dots, n\}$, otherwise n is \textbf{composite}.
\begin{nlemma}
    Let $p$ be prime, $a, b \in \Z$.  Then $p \mid ab \implies p \mid a$ or $p \mid b$.
\end{nlemma}

\begin{proof}
    Suppose $p \mid ab$, $p \nmid a$. Then $\gcd(a, b) \ne p$, so it must be $1$. So $\exists r, s \in \Z$ such that $ar + ps = 1$.
    Therefore, $b = (ab) r + p(bs)$, and hence $p \mid b$.
\end{proof}

This lets us prove the fundamental theorem of arithmetic.
\begin{thm}[Fundamental theorem of arithmetic]
    Every integer $n > 1$ can be written as a product of primes, and this representation is \emph{unique} up to ordering.
\end{thm}
\begin{proof}
    Existence is trivial. Uniqueness: suppose $n = p_1 \dots p_r = q_1 \dots q_s$. $p_1 \mid n$, so $p_1$ divides some $q_j$. Hence $p_1 = q_j$ and so we can cancel $p_1$ and $q_j$ from the relation, and repeat the process for $\frac{n}{p_1}$, eventually giving that the $\{p_1, \dots, p_r\}$ are the same as the $\{q_1, \dots, q_s\}$, up to ordering.
\end{proof}

If we know $a = \prod_{i=1}^k p_i^{\alpha_i}$, $b = \prod_{i=1}^k p_i^{\beta_i}$ for $\alpha_i, \beta_i \geq 0$ and $p_i$ are distinct primes, then by uniqueness of prime factorisation,
\begin{equation*}
    (a, b) = \prod_{i=1}^k p_i^{\gamma_i} \, , \quad \gamma_i = \min(\alpha_i, \beta_i)
\end{equation*}
However if $a, b$ are large, this is an inefficient way to compute GCDs.
\begin{defi}
    An algorithm with input an integer $N> 0$ is \textbf{polynomial time} if $\exists b, c > 0$ for which the algorithm completes after less than $c (\log N)^b$ `elementary operations'.
    Examples of elementary operations include adding or multiplying digits in some fixed base.

    If there are $k$ integer inputs, we require less than $c (\max_k(\log N_i))^b$ operations.
\end{defi}

\begin{eg}\leavevmode
    \begin{itemize}
        \item Adding, multiplying integers (usual method)
        \item Computing GCDs by Euclid's algorithm
        \item Testing if $N$ is prime (recent discovery, 2002)
    \end{itemize}
\end{eg}

\paragraph{Factoring} What about factoring $N$? The obvious method is trial division by integers $\leq \sqrt{N}$. If $N = pq$, then $p, q \sim \sqrt{N}$ this will take $\sqrt{N}$ divisions - asymptotically larger than any power of $\log N$.
For instance, if $N$ has $100$ digits, and we can do $2^9$ divisions every second, this will take around $10^{50} / 2^9$ seconds, which is about $6 \times 10^{39}$ years.  However, Euclid's algorithm will compute the GCD of two such numbers in a few milliseconds.
However, there are better algorithms for factoring which we will see later, but so far no polynomial-time algorithm is known (important for security of encryption algorithms like RSA).
These are practical for numbers with fewer than 200 digits (for a large computer - the record is 232 digits using thousands of computers and several months)

We will study the distribution of primes and the counting function later.  For now,
\begin{thm}[Euclid]
    There are infinitely many primes
\end{thm}
\begin{proof}
    It is enough to show that given $N$, there is a prime $p > N$. Let $q$ be the largest prime $\leq N$, and set $M = (2 \times 3 \times 5 \times \dots \times q) + 1$. If $p$ is any prime factor of $M$, then $p \notin \set{2, 3, \dotsc, q}$ so $p > N$.
\end{proof}

\begin{remark}
    This is constructive, in that it gives a way to find a prime greater than any $N$, but is is not efficient. For instance, if $N=1000$, $M$ has over $400$ digits.
\end{remark}

\paragraph{Finding large primes} For reasonable size numbers (fewer than 1000 digits), it is reasonable to pick numbers at random and test for primality.
For very large primes, there are special (faster) tests for primality of numbers of the form $N = 2^q - 1$, called Mersenne numbers.
Using these, it has been shown that that $2^q - 1$ is prime when $q = 74207281$.

\clearpage

\section{Congruences}
Fix $n \geq 1$ (the modulus).  Typically we will use $n > 1$.
\begin{defi}
    $ a \equiv b \pmod{n}$ if $n \mid a-b$, and we say `$a$ is congruent to $b$ mod $n$'
\end{defi}

This defines an equivalence relation on $\Z$. Write $\Z / n\Z$ for the set of equivalence classes $\set{a + n \Z}$, where $a + n \Z = b + n \Z \iff a \equiv b \pmod{n}$.  It is easy to see that the operations of addition and multiplication in $\set{a + n \Z}$ are well defined.  [In other words, $n \Z$ is an ideal in the ring $\Z$, and $\Z / n\Z$ is the quotient ring.]

\begin{nlemma}\label{lem:2_1}
    Let $a \in \Z$. The following are equivalent:
    \begin{enumerate}[label=\roman*.]
        \item $(a, n) = 1$
        \item $\exists b \in \Z$ with $ab \equiv 1 \pmod{n}$
        \item (The equivalence class of) $a$ is a generator of the group $(\Z/n\Z, +)$.
    \end{enumerate}
\end{nlemma}

\begin{proof}
    \leavevmode
    \begin{itemize}[label={}]
        \item i. $\Rightarrow$ ii. If $(a, n) = 1$, $\exists b, c \in \Z$ with $ab+nc=1$ so $ab \equiv 1 \pmod{n}$
        \item ii. $\Rightarrow$ i. $ab \equiv 1 \pmod{n} \iff ab+kn=1$, for some $k \in \Z \implies (a, n)= 1$
        \item ii. $\Leftrightarrow$ iii. $ab \equiv 1 \pmod{n}$ for some $b \iff 1$ belongs to the subgroup of $\Z / n \Z$ generated by $a \iff$ the subgroup generated by $a$ is $\Z / n \Z$
    \end{itemize}
\end{proof}

\begin{notation}
    For $n > 1$, we write $(\Z / n \Z)^*$ to denote the set of units (invertible elements) of $\Z / n \Z$. By lemma \ref{lem:2_1}, this is the set of classes $a + n \Z$ where $(a, n) = 1$.
    We can then define $\phi(n) =\# (\Z / n \Z)^* = \# \set{a \in \Z | 1 \leq a \leq n, \, (a, n) = 1}$, the \textbf{Euler $\phi$-function}.
\end{notation}

\begin{remark}
    For $n>1$, $\Z/n\Z$ is a field $\iff$ every non-zero element has an inverse under $X$ $\iff$ $n$ is prime $\iff$ $\phi(n) = n-1$.
\end{remark}

\begin{thm}[Euler-Fermat Theorem]
    If $(a, n) = 1$, then $a^{\phi(n)} \equiv 1 \pmod{n}$
\end{thm}

\begin{proof}
    $(n>1)$ Apply Lagrange's theorem to the group $G = (\Z/n\Z)^*$ which has order $\phi(n)$. Then $a \in \Z$ with $(a, n) = 1$ defines an element of $G$ whose order divides $\phi(n)$. So $a^{\phi(n)} \equiv 1 \pmod{n}$.
\end{proof}

This has an important special case, called Fermat's Little Theorem.
\begin{thm}[Fermat's Little Theorem]
    If $p$ is prime and $a \in \Z$, then $a^p \equiv a \pmod{p}$.
\end{thm}

\begin{proof}
    Trivial if $p \mid q$.  If not, $(a, p) = 1$ so $a^{\phi(p)} \equiv 1 \pmod{p} \implies a^p \equiv a \pmod{p}$
\end{proof}

% start of missing things

\begin{nlemma}\label{lem:2_2}
    Let $G$ be a cyclic group of order $n \geq 1$. Then
    \begin{align*}
        \varphi (n) &=  \# \set{g \in G | (\text{order of } g) = n} \\
                    &=  \# \text{ of generators of } G
    \end{align*}
\end{nlemma}

\begin{proof}
    We may assume $G = \Z/ n \Z$, in which case this is just $(2.1)$
\end{proof}

\subsection{Simultaneous Congruences}

\begin{eg}
    We would like to find all $x \in \Z$ such that $x \equiv 7 \pmod{10}$ and $x \equiv 3 \pmod{10}$.
    One way might be to try $7, 17, 27, \dotsc$ in turn.

    A better way: suppose we have $u, v \in \Z$ such that
    \begin{align*}
        u &\equiv 1 \pmod{10} & v &\equiv 0 \pmod{10} \\
        u &\equiv 0 \pmod{13} & v &\equiv 1 \pmod{13}
    \end{align*}

    Then $x = 7u + 3v$ is a solution.

    To find $u, v$: $(10, 13) = 1$ so $\exists r, s$ with $10r + 13s = 1$, so setting $u=13s$ and $v=10r$ ensures the above congruences are satified.  From the Euclidean algorithm, we see $r=4$ and $s=-3$ work, so $u=-39$ and $v=40$.

    We can confirm  $x = 7(-39) + 3(40) \equiv 107 \pmod{130}$ is a solution.
    In fact, the set of all solutions is $ \set{ x | x \equiv 107 \pmod {130}} $.
\end{eg}

This is a special case of

\begin{thm}[\hypertarget{thm:crt}{Chinese Remainder Theorem}]
    Let $m_1, \dotsc, m_k$ be integers $\geq 1$ with $(m_i, m_j) = 1$ if $i \neq j$ (they are pairwise coprime).
    Write $M = m_1 \dotsm m_k$ for $k \geq 2$. Let $a_1, \dotsc, a_k \in \Z$. Then there exists a solution $x \in \Z$ of
    \begin{equation}\label{eq:crt}
        \begin{cases}
            x \equiv a_1 \pmod{m_1} \\ \vdots \\ x \equiv a_k \pmod{m_k}
        \end{cases}
    \end{equation}
    and $x$ is unique mod $M$.
\end{thm}

\begin{remark}
    If $x$ satisfies \cref{eq:crt}, then so does $x+Mn$ for $n \in \Z$, so the solution is just $x + M\Z$.
\end{remark}

\begin{proof}
    \leavevmode
    \begin{itemize}
        \item Uniqueness: If $x, y$ satisfies  \cref{eq:crt}, then $m_i \mid (x-y)$ for every $i$. As no prime divides two of the $m_i$, it follows that $M= \prod m_i \mid (x-y)$, so $x \equiv y \pmod{M}$.
        \item Existence: Write $M_i = M/m_i = \prod_{j\neq i} m_j$.
            By the hypothesis, $(M_i, m_i) = 1$. So $ \exists c_i \in \Z$ with $c_i M _i \equiv 1 \pmod{m_i}$.
            Obviously $c_i M_i \equiv 0 \pmod{m_j}\; \forall j \neq i$. Let $x = \sum_{i=1}^k a_i c_i M_i$, then $x$ satisfies \cref{eq:crt}, as required.
    \end{itemize}
\end{proof}

Note we find the $c_i$ by Euclid's algorithm, so this is constructive.

\begin{cor}
    If $M = \prod_{i=1}^k m_i$, with $m_i$ pairwise coprime, then
    \begin{equation*}
        \varphi(M) = \varphi(m_1) \dotsm \varphi (m_k)
    \end{equation*}
\end{cor}

\begin{proof}
    $(a, M) = 1 \Leftrightarrow \forall i, (a, m_i)=1$. So by \hyperlink{thm:crt}{Chinese Remainder Theorem}, we have a bijection
    \begin{equation*}
        \set{ 1 \leq x \leq M | (x, M) = 1} \stackrel{\sim}{\longleftrightarrow} \set{ (a_1, \dotsc, a_k | 1 \leq a_i \leq m_i, (a_i, m_i) = 1 }
    \end{equation*} So
    % TODO fix
    \[ \#\text{LHS} = \varphi (M) \text{ , } \#\text{RHS} = \prod_i \varphi (m_i) \]
\end{proof}

Algebraic aside: We can write thus in terms of the rings $R_i = \Z / m_i \Z$.

\begin{defi}[Product Ring]
    The \textbf{product ring} is
    \begin{equation*}
        R_1 \times \dotsb \times R_k = \set{(r_1, \dotsc, r_k) | r_i \in R_i }
    \end{equation*} with $+, \times$ defined component-wise.
    This is a ring with $0$ as the zero vector, and $1$ as the vector of ones.
\end{defi}

\begin{nthm}
    Take $M = \prod m_i$, with $ m_i$ pairwise coprime.
    The map
    \begin{align*}
       \Theta : \Z/M\Z &\to \Z/m_1\Z \times \cdots \times \Z / m_k \Z \\
                       a + M \Z &\mapsto (a + m_1 \Z, \dotsc , a + m_k \Z )
    \end{align*}
    is an isomorphism of rings.
\end{nthm}

\begin{proof}
    $m_i \mid M \Rightarrow a+m_i \Z$ only depends on $a + M\Z$, so $\Theta$ is well-defined.
    It is a homomorphism (by definition of $+, \times$ in the product ring), and the \hyperlink{thm:crt}{Chinese Remainder Theorem} implies that it is bijective.
\end{proof}

\begin{defi}[Multiplicative function]\hypertarget{def:multiplicativeFunction}
    A \textbf{multiplicative function} is a function $f: \N = \set{1, 2, 3, \dotsc } \to \C$ for which
    \begin{equation*}
        (m, n) = 1 \implies f(mn) = f(m)f(n)
    \end{equation*}
    (This is the traditional terminology, although it is confusing we don't require $\forall m, n, f(mn)=f(m)f(n)$, which is sometimes called \textbf{totally multiplicative})
\end{defi}

\begin{eg}
    Examples of \hyperlink{def:multiplicativeFunction}{multiplicative functions}.
    \begin{itemize}
        \item $\varphi(n)$
        \item $\tau (n) = \#$ of positive divisors of  $n$
        \item $\sigma (n) = \sum_{1 \leq d \mid n} d$
        \item More generally $\sigma_k (n) = \sum_{1 \leq d \mid n} d^k$, note $\sigma = \sigma_1, \tau = \sigma_0$
    \end{itemize}
\end{eg}

\begin{nlemma}\label{lem:2_4}
    Let $f$ be a multiplicative function. Then so is $g$, defined by \begin{equation} g(n) = \sum_{d \mid n} f(d) \end{equation}
\end{nlemma}

\begin{proof}
    Let $(m, n) = 1$.
    Then $\set{ \text{divisors } d \text{ of } mn } = \set{ d = d_1 d_2 | d_1 \mid m, d_2 \mid n }$.
    \begin{equation*}
        g(mn) = \sum_{d \mid mn} f(d) = \sum_{d_1 \mid m} \sum_{d_2 \mid n} f(d_1 d_2) = \sum_{d_1 \mid m} f(d_1) \sum_{d_2 \mid n} f(d_2) = g(m)g(n)
    \end{equation*}
\end{proof}

\begin{eg}
    $f(n) = n^k$ (obviously multiplicative). Then $g(n) = \sigma_k(n)$.
    Later we will see how to recover $f$ from $g$.
\end{eg}

\begin{nthm}\label{thm:2_5}
    \leavevmode
    \begin{enumerate}[label=(\roman*)]
        \item $p$ prime, $k \leq 1 \implies \varphi(p^k) = p^{k-1} (p-1) = p^k \left(1-\frac{1}{p}\right)$
        \item $n \geq 1$: $\varphi (n) = n \prod_{p \mid n}\left( 1-\frac{1}{p} \right)$
        \item $\sum_{d \mid n} \varphi(d) = n$
    \end{enumerate}
\end{nthm}

\begin{proof}
    \leavevmode
    \begin{enumerate}[label=(\roman*)]
        \item $\varphi (p^k) = \# \set{ 1 \leq a \leq p^k | p \nmid a } = p^k - p^{k-1}$
        \item Write
            \begin{equation*}
                n = \prod_i p_i^{k_i}
            \end{equation*}
            with $p_i$ distinct. Then,
            \begin{align*}
                \varphi (n) &= \prod_i \varphi (p_i^{k_i}) \\% \text{ by Corollary to CRT } \\
                            &= \prod_i p_i^{k_i} \left(1 - \frac{1}{p_i}\right) \\
                            &= n \prod_i \left(1 - \frac{1}{p_i} \right)
            \end{align*}
        \item By the previous \cref{lem:2_4}, the left hand side is multiplicative. The right hand side is obviously multiplicative, so it is enough to prove for $n = p^k$.
            \begin{align*}
                \sum_{d \mid n} \varphi(d) &= \varphi(1) + \varphi(p) + \dotsb + \varphi(p^k) \\
                                       &= 1 + (p - 1) + (p^2 - p) + \dotsb + (p^k - p^{k-1}) \\
                                       &= p^k
            \end{align*}
    \end{enumerate}
\end{proof}

\subsection{Polynomial Congruences}

We will take $R = \Z, \Q$ or $\Z/n\Z$ (or any commutative ring with $1$)

Recall $R[X]$ refers to polynomials in $X$ taking coefficients from $R$, formally:
\begin{equation*}
    \set{a_n X^n + a_{n-1} X^{n-1} + \dots + a_0 \mid n \geq 0, \ a_i \in R}
\end{equation*}

Two polynomials are equal if their coefficients are the same.
Importantly, a polynomial $f \in R[X]$ determines a function $R \to R$, given by $\alpha \mapsto f(\alpha) = \sum a_i \alpha^i$.
It can happen that different polynomials give the same function.

\begin{eg}
    For $p$ a prime and $R = \Z/p\Z$, consider $f(X) = X^p - X$.
    Then $\forall a \in R$, $f(a) = 0$ in $\Z/p\Z$ by Fermat's Little Theorem.
    So $f$ and the zero polynomial determine the same function.
\end{eg}

Multiplication and addition of polynomials is defined in the obvious way: for $f = \sum_{i=0}^n a_i X^i$, $g = \sum_{i=0}^n b_i X_i$, we have
\begin{align*}
    f + g &= \sum_{i=0}^n (a_i + b_i) X^i \\
    fg &= \sum_{i=0}^{2n} \left(\sum_{j+k=i} a_j b_k\right) X^i
\end{align*}
so $R[X]$ is a ring.

We also have a division algorithm for polynomials, where the measure of size is the degree.

\begin{defi}
    $\deg(f)$ is the largest $i$ for which the coefficient of $X^i$ is non-zero, and $\deg(f) = \infty$ if $f$ is the zero polynomial.
\end{defi}

We also have $\deg(fg) \leq \deg(f) + \deg(g)$.

\begin{defi}[Divison algorithm for polynomials\hypertarget{def:polyDivisionAlg}]
    Let $f, g \in R[X]$. Assume that the leading coefficient of $g$ is a unit in $R$ (that is, has an inverse under multiplication)
    Then $\exists q, r \in R[X]$ with $\deg(r) < \deg(g)$ and $f = gq + r$.
\end{defi}

\begin{proof}
    Induction on $\deg f$. If $\deg f < \deg g$, then $q = 0$ and $r = f$ will do.

    Otherwise $f = a X^m + \dots$, $a \neq 0$, $g = b X^n + \dots$, with $b = \frac{1}{c}$ invertible by assumption and $m \geq n$.

    Then $f_1 = f - ac X^{m-n} g \in R[X]$ has degree strictly less than $m$. So $f_1 = g q_1 + r$ say, $\deg(r) < \deg(g)$ and so $f = (q_1 + ac X^{m-n}) g + r$, as required.
\end{proof}

\begin{ncor}[Remainder theorem\label{cor:remainderThm}]
    Take $f \in R[X]$ and $\alpha \in R$. Then \begin{equation*}f(X) = (X-\alpha) f_1(X) + f(\alpha)\end{equation*}
\end{ncor}

\begin{proof}
    Apply the division algorithm with $g=X-a$, so $f = (X-\alpha) f_1 + c$.
    $c$ has degree less than 1, so must be in $R$.
    Now, evaluate both sides at $X = \alpha$, so $c = f(\alpha)$.
\end{proof}

In particular, if $f(\alpha) = 0$ then $f(X) = (X - \alpha) f_1(X)$.

However in general a polynomial can have more roots than its degree - consider $f(X) = X^2 - 1$ with $R = \Z / 8\Z$

\begin{defi}
    A nonzero ring $R$ is an integral domain if $ab=0$ implies $a=0$ or $b=0$.
\end{defi}

\begin{eg}
    $\Q$ and $\Z$ are integral domains, and $\Z/n\Z$ is an integral domain if and only if $N$ is prime.
\end{eg}

\begin{nthm}\label{thm:2.7}
    If $R$ is an integral domain, and $f \in R[X]$ is a non-zero polynomial of degree $n \geq 0$, then $f$ has $\leq n$ roots in $R$.
\end{nthm}

\begin{cor}[Lagrange's Theorem]
    Take $p$ prime, $f \in \Z[X]$ of degree $n$, and $f$ not divisible by $p$.
    Then the congruence $f(x) \equiv 0 \pmod{p}$ has $\leq n$ solutions mod $p$.
\end{cor}

\begin{proof}
    The $n=0$ case is trivial.

    Suppose $n > 0$. If $f$ has no roots in $R$, we have nothing to prove.

    Otherwise $\exists \alpha \in R$, $f(\alpha) = 0$ so $f(X) = (X - \alpha) f_1(X)$, $f_1 \in R[X]$ with $\deg(f_1) = n-1$.
    By induction, $f_1$ has $\leq n-1$ roots in $R$.
    If $\beta$ is a root of $f$, then $(\beta-\alpha) f_1(\beta) = 0$ so either $\beta = \alpha$ or $f_1(\beta) = 0$, as $R$ is an integral domain.
    So, the roots of $f$ are exactly $\alpha$ and the roots of $f_1$, so $f$ has $\leq n$ roots.
\end{proof}

\begin{eg}
    Take $p$ prime, and set
    \begin{equation*}f(X) = X^{p-1} - 1 - \prod_{a=1}^{p-1} (X - a) \in \Z / p \Z [X]\end{equation*}
    Then, $\deg f \leq p-2$. If $a=1, \dotsc, p=1$ then $a^{p-1} \equiv 1 \pmod{p}$ so $f(a) = 0 \in \Z/p\Z$.
    So as $f$ has $\geq p-1$ roots mod $p$, it must be identically zero mod $p$. So $f(0)$ is zero mod $p$, and
    \begin{equation*}
        -1 - \prod_{a=1}^{p-1} (-a) \equiv 0 \pmod{p}
    \end{equation*}
    Giving us Wilson's Theorem, $(p-1)! \equiv -1 \pmod{p}$.
\end{eg}

The additive group $(\Z / n\Z, +)$ is cyclic. What about $((\Z/n\Z)^*, \times)$?

\begin{eg}
    Consider $n=7$, then we can check $3$ is a generator of $(\Z / n \Z)^*$ and hence the group is cyclic.
\end{eg}

\begin{nthm}
    If $p$ is prime, then $G = (\Z / p \Z)^*$ is cyclic of order $p-1$.
\end{nthm}

\begin{proof}
    $\# G = p-1 = \sum_{d \mid p-1} \phi(d)$ by \cref{thm:2_5} part (iii).

    Also, by Lagrange's Theorem in elementary group theory, \begin{equation*}\# G = \sum_{d \mid p-1} \# \set{g \in G \ \text{of order d}} = \sum_{d \mid p-1} N_d\end{equation*}
    Suppose $G$ is not cyclic, so $G$ has no element of order $p-1$, then ${N_{p-1} = 0 < \phi(p-1)}$.
    As $\sum \phi(d) = \sum N_d$, there exists some $d$ for which $N_d > \phi(d) > 0$. Let $\alpha \in G$ be an element of order $d$.
    Then $\langle\alpha\rangle \coloneqq \set{1, \alpha, \alpha^2, \dotsc, \alpha^{d-1}} \subset G$ is a cyclic subgroup of order $d$ so has exactly $\phi(d)$ elements of order $d$ by \cref{lem:2_2}.
    So $\exists \beta \notin \langle\alpha\rangle$ where $\beta$ has order $d$.
    Then $1, \alpha, \alpha^{d-1}, \beta$ are $(d+1)$ roots of the polynomial $X^d - 1$, contradicting \cref{thm:2.7}.
    So, $G$ must be cyclic.
\end{proof}
\end{document}
