\documentclass{article}

% preamble
\def\npart{III}
\def\nyear{2019}
\def\nterm{Lent}
\def\draft{Unfinished course}
\def\nlecturer{Dr M. Tointon}
\def\ncourse{Introduction to Approximate Groups}

\usepackage{imakeidx}
\usepackage{marginnote}

\input{header}
\newtheorem{nexample}[nthm]{Example}
\reversemarginpar

\makeindex[intoc]

\newcommand{\named}[1]{\textbf{#1}\index{#1}}
\newcommand{\bonusnamed}[1]{\textbf{#1}\index{#1@*#1}}
\newcommand{\F}{\mathbb{F}}

\setcounter{section}{-1}
\numberwithin{equation}{section}

% and here we go!
\begin{document}
\maketitle

\tableofcontents

\clearpage
\section{Introduction}
A\marginnote{\emph{Lecture 1}}[0cm] subgroup $H < G$ is a non-empty set closed under products and inverses.
Roughly, an `approximate subgroup' is a subset that is only `approximately closed' under products.  (Will make this precise soon).
Such sets arise naturally in a number of branches of mathematics, and as such approximate groups have had a broad range of applications.
In this course, we will look in detail, for example, at applications to \emph{polynomial growth} (fundamental in geometric group theory) and touch on construction of expander graphs (important in theoretical computer science).

\clearpage
\section{Small doubling}
To start with, we will look at a preliminary notion of approximate closure called \emph{small doubling}.
In this course, $G$ is always a group, arbitrary unless specified otherwise.
\begin{notation}
Given $A,B \subset G$, write
\begin{align*}
  AB &\coloneqq \{ab \mid a \in A, b \in B\} \quad \text{`Product sets'} \\
  A^n &= \underbrace{A \cdot A \dotsm A}_{n\text{ times}} \\
  A^{-1} &= \{a^{-1} \mid a \in A\} \\
  A^{-n} &= (A^{-1})^n
\end{align*}
When $G$ is abelian, often switch to additive notation, e.g.\ $A + B$, $nA$, $-A$, $-nA$, called `Sum sets'.
\end{notation}

To say $A$ is closed is to say $A^2 = A$. If $A$ is finite, one way to say that $A$ is `approximately closed' is to say that
\begin{equation*}
  |A^2| \text{ is `not much bigger' than } |A|.
\end{equation*}

This is the notion of approximate closure that arises when studying polynomial growth or expansion, for example.

To get a feel for what this should mean, let's look at the possible values of $|A^2|$.
Trivially, $|A| \leq |A^2| \leq |A|^2$. Both bounds are attained. However, although the quadratic upper bound on $|A^2|$ in terms of $|A|$ is extremal, in a strict sense, it should not be seen as atypical for the size of $A^2$.
We will see, for example, in Example Sheet 1 that if $A$ is a set of size $n$ chosen uniformly from $\{1, \dotsc, n^{100}\}$, then $\mathbb{E}(|A+A|)$ is close to $\frac{1}{2} |A|^2$ (about as large as it can be, because abelian).
Therefore, we can view sets satisfying
\begin{equation}
  |A^2| = o\left(|A|^2\right) \label{eq:1.1}
\end{equation}
as being `exceptional', and so condition \eqref{eq:1.1} can already be seen as a form of `approximate closure'.
In this course, we will concentrate on the strongest form of \eqref{eq:1.1}, where $|A^2|$ is \emph{linear} in $|A|$, in the sense that
\begin{equation}
  |A^2| \leq K |A| \label{eq:1.2}
\end{equation}
for some $K \geq 1$ fixed a priori.

Since such sets are `far from random' we can expect \eqref{eq:1.2} to impose a significant restriction on $A$.
The main aim of this course is to work out how significant.

\begin{defi}[Small doubling]
  Given $A \subset G$, the ratio $\frac{|A^2|}{|A|}$ is called the \named{doubling constant} of $A$.
\end{defi}
If $A$ satisfies \eqref{eq:1.2}, we'll say that $A$ has \named{doubling} at most $K$, or simply \named{small doubling}.

\begin{eg}[Some simple examples]\leavevmode
  \begin{itemize}
    \item (Empty set)
    \item $A$ a finite subgroup ($K=1$)
    \item $|A| \leq K$
    \item $A \subset \mathbb{Z}$, $A = \{-n, \dotsc, n\}$, $|A+A| \leq 2 |A|$.
  \end{itemize}
\end{eg}
This last example is especially important as it shows the theory does not just reduce to subgroups and `small' sets.
We'll develop these examples later in the course.

One main aim will be to prove theorems along the lines of:
\begin{center}
  $A$ has small doubling $\Rightarrow A$ has a certain structure.
\end{center}
When $K$ is very small, this is quite easy, as follows:

\begin{nthm}[Freiman; proof due to Tao]\label{thm:1.1}
  Let $K < \frac{3}{2}$. Suppose $A \subset G$ and $|A^2| \leq K|A|$.
  Then there is a subgroup $H < G$ with $|H| = |A^2| (\leq K|A|)$ such that $A \subset aH = Ha \quad \forall a \in A$
  (i.e.\ $A$ is a large portion of a coset of a finite subgroup).
\end{nthm}
\begin{remark}
  Converse: If $A \subset xH = Hx$ for $x \in G$, $H < G$, $|H| \leq K|A|$ then $|H^2| \leq K|A|$.
  So this is a complete classification of sets of very small doubling.
\end{remark}
\begin{nlemma}[Identify $H$]\label{lem:1.2}
  If $|A^2| \leq \frac{3}{2}\abs{A}$ then $H = A^{-1} A$ is a subgroup.
  Moreover, $A^{-1}A = A A^{-1}$, and $|H| < 2 |A|$.
\end{nlemma}
\begin{proof}
  Let $a,b \in A$.
  The hypothesis gives $|aA \cap bA| > \frac{1}{2}|A|$, so there are $\geq \frac{1}{2}$ pairs $(x,y) \in A \times A$ such that $ax = by$, i.e.\ $a^{-1} b = x y^{-1}$.
  This immediately gives $A^{-1} A \subseteq A A^{-1}$, and replacing $A$ by $A^{-1}$ gives $A A^{-1} \subseteq A^{-1} A$, so $A^{-1}A = A A^{-1}$ as required.

  Since $|A \times A| = |A|^2$ it also implies that
  \begin{equation*}
    \abs{A^{-1}A} \leq \frac{\abs{A}^2}{\frac 12 \abs{A}} = 2 |A|,
  \end{equation*}
  (dividing by number of repetitions), as claimed.

  Note also that $A^{-1}A$ is symmetric, so it remains to show that $A^{-1}A$ is closed under products.

  Let $c,d \in A$. As above, $\exists > \frac{1}{2}|A|$ pairs $(u,v) \in A \times A$ such that $c^{-1} d = u v^{-1}$.
  This means that for at least one pair $(x,y)$ from above and one pair $(u,v)$, we have $y=u$.
  In particular, $a^{-1} b c^{-1} d = x v^{-1} \in A A^{-1} = A^{-1} A$.
\end{proof}
\begin{nlemma}[Size bound]
  If $|A^2| < \frac{3}{2} |A|$ then $A^2 = a H a \quad \forall a \in A$ ($H$ as before). In particular, $|H| = |A^2|$.
\end{nlemma}
\begin{proof}
  First, note that
  \begin{equation}
    A \subset aH \cap Ha \label{eq:1.3}
  \end{equation}
  by definition of $H$, so certainly $A^2 \subset a Ha$. For the reverse inclusion, let $z \in a H a$.
  Since $H$ is a subgroup, there are $|H|$ pairs $(x,y) \in aH \times Ha$ such that $z = xy$.

  Moreover, by \eqref{eq:1.3} and the bound $|H| < 2|A|$ from \cref{lem:1.2}, more than half of these $x$ and more than half of these $y$ belong to $A$.
  In particular, this means that for at least one pair $x,y$, both have to belong to $A$.
  Hence $z = xy \in A^2$, as required.
\end{proof}
\begin{proof}[Proof of \cref{thm:1.1}]
  Given $a \in A$, we have $A a^{-1} \subset a H a^{-1} \cap H$ so
  \begin{equation*}|a H a^{-1} \cap H| \geq |A| > \frac{1}{2} |H|\end{equation*}
  by \cref{lem:1.2}, but the only subgroup of $H$ of size $> \frac{1}{2}|H|$ is $H$ itself.
  Hence $a H a^{-1} = H$, so indeed $A \subset a H = Ha$ by \eqref{eq:1.3}.
\end{proof}
Classifying the sets of small doubling is much harder than this in general, and uses a much wider range of techniques, e.g.\ group theory, harmonic analysis, geometry of numbers...

% lecture 2
\section{Covering and higher sum and products sets}
We introduce two techniques we'll use repeatedly: \emph{covering} and \emph{bounding higher product sets}. A nice way to do this is by proving the following theorem.
\begin{nthm}[Rusza]\label{thm:2.1}
  missing % missing
\end{nthm}
% missing

We'll start by proving the following weaker version:
\begin{nprop}\label{prop:2.2}
  Suppose $A \subset \F_p^r$ satisfies $|2A - 2A| \leq K|A|$. Then $\exists H < \F_p^r$ with $|H| \leq p^K |A - A| (\leq p^K K |A|)$ such that $A \subset H$.
\end{nprop}
We'll prove this using `covering', encapsulated by the following lemma
\begin{nlemma}[Rusza's covering lemma]\label{lem:2.3}
  missing % missing
\end{nlemma}
% missing
\begin{proof}
  First, disjointness of $xB \Rightarrow |XB| = |x| |B|$. Since $X \subset A$, $|XB| \leq |AB| \leq K|B|$, so $|X| \leq K$.
  Maximality gives $\forall a \in A \; \exists x \in X$ such that $aB \cap xB \neq \emptyset$, and hence $a \in x B B^{-1}$.
  Hence $A \subset X B B^{-1}$, as required.
\end{proof}
\begin{nlemma}\label{lem:2.4}
  Suppose $A \subset G$ satisfies $A^{-1} A^2 A^{-1}| \leq K|A|$. Then $\exists x \subset A^{-1} A^2$, $|X| \leq K$ such that $A^{-1} A^n \subset X^{n-1} A^{-1} A \; \forall n \in \mathbb{N}$.
\end{nlemma}
\begin{proof}
  \cref{lem:2.3} $\Rightarrow$ $\exists x \subset A^{-1} A^2$, $|X| \leq K$ such that
  \begin{equation}
    A^{-1} A^2 \subset X A^{-1} A. \label{eq:2.1}
  \end{equation}
  We then have
  \begin{align*}
    A^{-1} A^n &= A^{-1} A^{n-1} A \\
    \subset X^{n-2} A^{-1} A^2 \quad\text{by induction}\\
    \subset X^{n-1} A^{-1} A. \quad\text{by \eqref{eq:2.1}}\qedhere
  \end{align*}
\end{proof}
\begin{proof}[Proof of \cref{prop:2.2}]
  \Cref{lem:2.4} $\Rightarrow \exists X,\; |X| \leq K$ such that
  \begin{equation*}
    nA - A \subset (n-1) X + A - A \; \forall n \in \mathbb{N}.
  \end{equation*}
  This means that
  $\langle A \rangle \subset \langle X \rangle + A - A$, so
  \begin{equation*}
    |\langle A \rangle | \leq \abs{\langle X \rangle} |A-A| \leq p^K |A-A|
  \end{equation*}
  as claimed.
\end{proof}
To strengthen \cref{prop:2.2} to \cref{thm:2.1}, we use the second technique of this section, bounding higher sum/product sets. The key result is the following, at least in the abelian case.
\begin{nthm}[Pl\"unnecke-Rusza]\label{thm:2.5}
  Suppose $A \subset G$ (abelian) and $|A+A| \leq K|A|$.
  Then $|mA - nA| \leq K^{m+n} |A| \; \forall m, n \geq 0$.
\end{nthm}
Was proved in Introduction to Discrete Analysis last term. We won't redo the whole proof, but we will reprove some parts of it.
\begin{proof}[Proof of \cref{thm:2.1}]
  \cref{thm:2.5} $\Rightarrow |2A - 2A| \leq K^4 |A|$, and $|A-A| \leq K^2 |A|$. Then immediate from \cref{prop:2.2}.
\end{proof}

We'll spend the rest of this section discussing \cref{thm:2.5} and variants of it.
We've seen it's useful, at least in one context. To see more philosophically why it's useful, let's think about what the genuine closure of subgroups undeer products and inverses means.
One useful feature is that it can be iterated, given $h_1, h_2, \dotsc \in H$, a subgroup, this means that $h_1^{\epsilon_1} \dotsm h_m^{\epsilon_m} \in H\; \forall \epsilon_i = \pm 1$, $\forall n, \forall h_i \in H$.
\cref{thm:2.5} allows us to `iterate' the `approximate closure' of a set of small doubling:
$a_1 + \dotsb + a_m - a_1' - \dotsb - a_n'$ may not belong to $A$, but at least it belongs to $mA - nA$, which is
\begin{enumerate}[label=(\alph*)]
  \item not too large ($|mA + nA| \leq K^{m+n} |A|$)
  \item itself a set of small doubling ($|2(mA-nA)| \leq K^{2m+2n} |mA - nA|$).
\end{enumerate}
This is an important part of why the theory works so well.

It is therefore unfortunate that \cref{thm:2.5} does not hold for non-abelian groups:
\begin{nexample}\label{eg:2.6}
  Let $x$ generate an infinite cyclic group $\langle x \rangle$, $H$ be a finite group, set $G = H * \langle x \rangle$ (the free product, which has the important property that $x^{-1} H x \neq H$).
  Set $A = H \cup \{x\}$.
  $A^2 = H \cup x H \cup H x \cup \{x^2\}$, so $|A^2| \leq 3 |A|$. But $A^3$ contains $HxH$, which has size $|H|^2 \sim |A|^2$.

  So as $|H| \to \infty$, \cref{thm:2.5} cannot hold.
\end{nexample}

Nonetheless, if we strengthen small doubling slightly, we can recover a form of \cref{thm:2.5}.
One way is to replace small doubling with small tripling: i.e.\ $|A^3| \leq K|A|$.
\begin{nprop}
  Suppose $A \subset $, $|A^3| \leq K|A|$. Then $|A^{\epsilon_1} \dotsm A^{\epsilon_m}| \leq K^{3(m-2)} |A|$ $\forall \epsilon_i = \pm 1$, $\forall m \geq 3$.
\end{nprop}
Key ingredient is the following:
\begin{nlemma}[Rusza's triangle inequality]\label{lem:2.8}
  Given $U,V,W \subset G$, all finite, we have
  \begin{equation*}
    |U| |V^{-1} W| \leq |UV| |UW|.
  \end{equation*}
\end{nlemma}
\begin{proof}
  We'll define an injection $\varphi: U \times V^{-1} W \to UV \times UW$.
  First, for $x \in V^{-1}W$, set $v(x) \in V$ and $w(x) \in W$ such that $x = v(x)^{-1} w(x)$.
  Set $\varphi(u,x) = (uv(x), uw(x))$. To see injective, first $(uv(x))^{-1} (uw(x)) = x$, so $x$ determined by $\varphi(u,x)$, and then $(uv(x))v(x)^{-1} = u$, so $u$ is also determined by $\varphi(u,x)$.
\end{proof}
\begin{proof}
  First we'll do the case $m=3$.
  \begin{itemize}
    \item $|A^3| = |A^{-3}| \leq K|A|$.
    \item Apply \cref{lem:2.8} with $U=W=A$, $V = A^2$.
      Get $|A| |A^{-2} A| \leq |A^3| |A^2| \leq K^2 |A|^2$, so $|A^{-2} A| \leq K^2 |A|$.
    \item Note that $(A^{-2} A)^{-1} = A^{-1} A^2$, so $|A^{-1} A^2| = |A^{-2} A| \leq K^2 |A|$.
    \item Replacing $A$ by $A^{-1}$ we get
      \begin{equation*}
        |A A^{-2}| = |A^2 A^{-1}| \leq K^2 |A|.
      \end{equation*}
    \item Finally, \cref{lem:2.8} with $U=V=A$< $W = A A^{-1}$ gives
      \begin{equation*}
        |A| |A^{-1} A A^{-1}| \leq |A^2| |A^2 A^{-1}| \leq K^3 |A|^2.
      \end{equation*}
      So $|A^{-1} A A^{-1}| \leq K^3 |A|$. For last case, swap $A,A^{-1}$ again.
  \end{itemize}
  For $m \geq 4$, \cref{lem:2.8} $\Rightarrow$
  \begin{align*}
    |A| |A^{\epsilon_1} \dotsm A^{\epsilon_m} &\leq |A A^{-\epsilon_2} A^{-\epsilon_1}| |A A^{\epsilon_3} \dotsm  A^{\epsilon_m}| \\
                                              & \leq |K| |A| K^{3m} |A|.
  \end{align*}
\end{proof}
\printindex
\end{document}
