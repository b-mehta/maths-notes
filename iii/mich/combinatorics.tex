\documentclass{article}

\def\npart{III}
\def\nyear{2018}
\def\nterm{Michaelmas}
\def\nlecturer{Professor I.\ B.\ Leader}
\def\ncourse{Combinatorics}
\def\draft{Ongoing course, rough}
\usepackage{imakeidx}
\usepackage{chngcntr}
\input{header}
\makeindex[intoc]
\usetikzlibrary{fadings, decorations.pathmorphing}

% preamble

\setcounter{section}{-1}
\counterwithout{nthm}{section}

\DeclarePairedDelimiter\ceil{\lceil}{\rceil}
\DeclarePairedDelimiter\floor{\lfloor}{\rfloor}

\newcommand{\ihalf}[1]{\floor{\frac{#1}{2}}}
\newcommand{\ihalfc}[1]{\ceil{\frac{#1}{2}}}

%\newtheorem{manualtheoreminner}{Theorem}
%\newenvironment{manualtheorem}[1]{%
%    \renewcommand\themanualtheoreminner{#1}%
%    \manualtheoreminner
%}{\endmanualtheoreminner}

% and here we go!

\let\oldsubset\subset
\let\subset\subseteq

\begin{document}
\maketitle

\tableofcontents

\clearpage
\section{Introduction}
Combinatorics tends to have problems which are easy to state and hard to prove.
One of the reasons for this is that it is often unclear where to start - for instance in linear algebra we can often start by picking a basis.
Proofs tend to have the property that they seem to take thousands of years to come up with, and a single line to write down.
In this course, we learn some techniques which make problems sounding very hard become very easy.

We start with set systems, which builds on the idea of subsets and containment.
Next, we study isoperimetric inequalities.
In the continuous case, in the plane, a typical problem is to find the maximum area one can enclose with a fixed perimeter, which is solved by a circle.
Similarly, a soap bubble will minimise its surface area for a fixed volume.
Here, in the discrete case, we will try to understand `how tightly' we can pack subsets.
Finally, we look at continuous projections.
For instance, given a subset of space, suppose we know the $z$-coordinate of all points is between $0$ and $1$, and the projection to the $xy$-plane has area $A$, we know the total volume is bounded by $A$.
We generalise this result into higher dimensions and the box result, which has applications in combinatorics.

While all examinable proofs will be included in lectures, relevant books for this course are:
\begin{enumerate}
  \item \emph{Combinatorics}, Bollob\'{a}s, C.U.P., 1996. This matches chapter 1 excellently and parts of chapter 2. It is a gentle read and includes other developments in combinatorics.
  \item \emph{Combinatorics of finite sets}, Anderson, O.U.P., 1987. It is a simple and clear study on chapter 1.
\end{enumerate}

\clearpage
\section{Set systems}
\begin{defi}[Set system]\index{set system}\hypertarget{def:ss}
  Let $X$ be a set. A \textbf{set system} on $X$ (or \textbf{family of subsets} of $X$) is a family $\mathcal{A} \subseteq \mathcal{P}(X)$.
\end{defi}
For instance, we write \hypertarget{def:superr}$X^{(r)} = \set{A \subset X | |A| = r}$, so $X^{(r)}$ is a \hyperlink{def:ss}{set system} on $X$.
Unless otherwise stated,
\begin{equation*}
  \hypertarget{def:ints}X = [n] \coloneqq \{1,2,\dotsc,n\},
\end{equation*}
e.g.\ $|X^{\hyperlink{def:superr}{(r)}}| = \binom{n}{r}$.
Thus $\hyperlink{def:ints}{[4]}^{(2)} = \{12,13,14,23,24,34\}$, so $|[4]^{(2)}| = 6$.

Often, we make $\mathcal{P}(X)$ into a graph, called $Q_n$, by joining $A$ to $B$ if $|A \triangle B| = 1$, i.e.\ if $A = B \cup \{i\}$ for some $i \notin B$ (or vice versa).
For instance, here is a picture of $Q_3$:
\begin{center}
  \begin{tikzpicture}[xscale=1.4, every node/.style={fill=black, circle, inner sep=1pt}]
    \node [label=below:$\emptyset$] (empty) at (0,0) {};
    \node [label=left:$1$] (1) at (-1,1) {};
    \node [label=below right:$2$] (2) at (0,1) {};
    \node [label=right:$3$] (3) at (1,1) {};
    \node [label=left:$23$] (23) at (-1,2) {};
    \node [label=above right:$13$] (13) at (0,2) {};
    \node [label=right:$12$] (12) at (1,2) {};
    \node [label=above:$123$] (123) at (0,3) {};
    \draw (empty) -- (1);
    \draw (empty) -- (2);
    \draw (empty) -- (3);
    \draw (1) -- (12);
    \draw (1) -- (13);
    \draw (2) -- (12);
    \draw (2) -- (23);
    \draw (3) -- (13);
    \draw (3) -- (23);
    \draw (12) -- (123);
    \draw (13) -- (123);
    \draw (23) -- (123);
  \end{tikzpicture}
\end{center}

As we know, the picture gets `thicker' in the middle. But, for odd $n$, is it not clear where exactly the middle is, so in the odd case we have two equally sized large blobs in the middle.

\begin{center}
  \begin{tikzpicture}
    \begin{scope}
      \node at (-2, 3) {$Q_n$, $n$ even};

      \draw (0,3.2) circle [x radius=1mm, y radius=1mm];
      \node [right] at (0.25, 3.2) {$\hyperlink{def:superr}{X^{(n)}}$};

      \draw (0,2.7) circle [x radius=4.5mm, y radius=2mm];
      \node [right] at (0.5, 2.7) {$X^{(n-1)}$};

      \draw (0,1.9) circle [x radius=9mm, y radius=4mm];
      \node [right] at (0.9, 1.9) {$X^{(n-2)}$};

      \node at (0,1.25) {$\vdots$};

      \draw (0,0) circle [x radius=16mm, y radius=8mm];
      \node [right] at (1.6, 0) {$X^{(\frac{n}{2})}$};

      \node at (0,-1.05) {$\vdots$};

      \draw (0,-1.9) circle [x radius=9mm, y radius=4mm];
      \node [right] at (0.9, -1.9) {$X^{(2)}$};

      \draw (0,-2.7) circle [x radius=4.5mm, y radius=2mm];
      \node [right] at (0.5, -2.7) {$X^{(1)}$};

      \draw (0,-3.2) circle [x radius=1mm, y radius=1mm];
      \node [right] at (0.25, -3.2) {$X^{(0)}$};
    \end{scope}

    \begin{scope}[xshift=6cm]
      \node at (-2, 3) {$Q_n$, $n$ odd};

      \draw (0,3.2) circle [x radius=1mm, y radius=0.8mm];
      \node [right] at (0.25, 3.2) {$X^{(n)}$};

      \draw (0,2.8) circle [x radius=4.5mm, y radius=1.5mm];
      \node [right] at (0.5, 2.8) {$X^{(n-1)}$};

      \draw (0,2.1) circle [x radius=9mm, y radius=3mm];
      \node [right] at (0.9, 2.1) {$X^{(n-2)}$};

      \node at (0,1.55) {$\vdots$};

      \draw (0,0.6) circle [x radius=16mm, y radius=5mm];
      \node [right] at (1.6, 0.6) {$X^{(\ceil{\frac{n}{2}})}$};

      \draw (0,-0.6) circle [x radius=16mm, y radius=5mm];
      \node [right] at (1.6, -0.6) {$X^{(\floor{\frac{n}{2}})}$};

      \node at (0,-1.35) {$\vdots$};

      \draw (0,-2.1) circle [x radius=9mm, y radius=3mm];
      \node [right] at (0.9, -2.1) {$X^{(2)}$};

      \draw (0,-2.8) circle [x radius=4.5mm, y radius=1.5mm];
      \node [right] at (0.5, -2.8) {$X^{(1)}$};

      \draw (0,-3.2) circle [x radius=1mm, y radius=0.8mm];
      \node [right] at (0.25, -3.2) {$X^{(0)}$};
    \end{scope}
  \end{tikzpicture}
\end{center}

If we identify a set $A \subseteq X$ with a $0$-$1$ sequence of length $n$, e.g.\ $134 \longleftrightarrow 1011000\dots0$, via $A \longleftrightarrow 1_{A}$ or $\chi_A$, the characteristic function,
then $Q_3$ looks like
\begin{center}
  \begin{tikzpicture}[every node/.style={fill=black, circle, inner sep=1pt}, scale=2.5]
    \node [label=below left:$\emptyset$] (empty) at (0,0) {};
    \node [label=below right:$1$] (1) at (1, 0) {};
    \node [fill opacity=0.5, label=left:$2$] (2) at (0.3,0.3) {};
    \node [label=left:$3$] (3) at (0, 1) {};
    \node [label=above left:$13$] (13) at (1, 1) {};
    \node [label=right:$12$] (12) at (1.3, 0.3) {};
    \node [label=above left:$23$] (23) at (0.3, 1.3) {};
    \node [label=above right:$123$] (123) at (1.3, 1.3) {};
    \draw (empty) -- (1);
    \draw [opacity=0.7, very thin] (empty) -- (2);
    \draw (empty) -- (3);
    \draw (1) -- (12);
    \draw (1) -- (13);
    \draw [opacity=0.7, very thin] (2) -- (12);
    \draw [opacity=0.7, very thin] (2) -- (23);
    \draw (3) -- (13);
    \draw (3) -- (23);
    \draw (12) -- (123);
    \draw (13) -- (123);
    \draw (23) -- (123);
  \end{tikzpicture}
\end{center}
\begin{defi}[Hypercube]\index{hypercube}\hypertarget{def:qn}
  $Q_n$ is often called the \textbf{hypercube} or \textbf{discrete cube} or \textbf{$n$-cube}.
\end{defi}
It is important to keep \emph{both} these pictures in mind: for induction the cube image is more instructive, but when thinking about layers the earlier image is more helpful.

\subsection{Chains and antichains}
\begin{defi}[Chain]\index{chain}\hypertarget{def:chain}
  A family $\mathcal{A} \subseteq \mathcal{P}(X)$ is a \textbf{chain} if $\forall A, B \in \mathcal{A}$, we have $A \subseteq B$ or $B \subseteq A$.
\end{defi}
\begin{defi}[Antichain]\index{antichain}\hypertarget{def:antichain}
  A family $\mathcal{A} \subseteq \mathcal{P}(X)$ is an \textbf{antichain} if $\forall A,B \in \mathcal{A}$ with $A \neq B \Rightarrow A \nsubseteq B$.
\end{defi}
\begin{eg}
  For instance, $\{12, 125, 123589\}$ is an \hyperlink{def:chain}{chain}, and $\{1,467,2456\}$ is an \hyperlink{def:antichain}{antichain}.
\end{eg}

In this course, we ask questions like, how large can a \hyperlink{def:chain}{chain} be?
We can achieve $|\mathcal{A}| = n+1$, e.g.\ $\{\emptyset, 1, 12, 123, \dotsc, [n]\}$.
It is easy to visualise this by picking `one per level':
\begin{center}
  \begin{tikzpicture}
      \draw (0,3.2) circle [x radius=1mm, y radius=1mm];
      \draw (0,2.7) circle [x radius=4.5mm, y radius=2mm];
      \draw (0,1.9) circle [x radius=9mm, y radius=4mm];
      \node at (0,1.25) {$\vdots$};
      \draw (0,0) circle [x radius=16mm, y radius=8mm];
      \node at (0,-1.05) {$\vdots$};
      \draw (0,-1.9) circle [x radius=9mm, y radius=4mm];
      \draw (0,-2.7) circle [x radius=4.5mm, y radius=2mm];
      \draw (0,-3.2) circle [x radius=1mm, y radius=1mm];
      \begin{scope}[every node/.style={fill=black, circle, inner sep=0.5pt}]
        \node (0) at (0,-3.2)    {};
        \node (1) at (0.1,-2.7)  {};
        \node (2) at (-0.2,-1.8) {};
        \node (3) at (0.3, 0.1)   {};
        \node (4) at (0.2,1.8)   {};
        \node (5) at (-0.1,2.7)  {};
        \node (6) at (0,3.2)     {};
        \draw[very thin, gray] (0) -- (1) -- (2) -- (3) -- (4) -- (5) -- (6);
      \end{scope}
  \end{tikzpicture}
\end{center}

We cannot exceed $n+1$, since a chain must meet each `level' $X^{(r)}$ ($0 \leq r \leq n$) in at most one place.

How large can an \hyperlink{def:antichain}{antichain} be?
We could achieve $\mathcal{A}=n$, e.g.\ $\mathcal{A} = \{1,2,3,\dotsc,n\}$ (and this is maximal).
Indeed, we could take $\mathcal{A} = X^{(r)}$ for any $r$, so we can achieve $|\mathcal{A}| = \binom{n}{\floor{\frac{n}{2}}}$.
Can we beat this?
Aim: Prove this is the winner.

% lecture 2
Inspired by `each \hyperlink{def:chain}{chain} meets each level $X^{(r)}$ in at most one place' for chains, we try to decompose $\hyperlink{def:qn}{Q_n}$ into chains to find large \hyperlink{def:antichain}{antichains}.
\begin{nthm}[Sperner's Lemma]\label{thm:sperner}\index{Sperner's Lemma}
  Let $\mathcal{A} \subseteq \mathcal{P}(X)$ be an \hyperlink{def:antichain}{antichain}.
  Then $|\mathcal{A}| \leq \binom{n}{\floor{\frac{n}{2}}}$.
\end{nthm}
\begin{proof}
  It is sufficient to partition $\mathcal{P}(X)$ into $\binom{n}{\floor{\frac{n}{2}}}$ \hyperlink{def:chain}{chains}.
  For this, it is sufficient to show
  \begin{enumerate}[label=(\roman*)]
    \item $\forall r < \frac{n}{2}$, there is a matching from \hyperlink{def:superr}{$X^{(r)}$} to $X^{(r+1)}$
    \item $\forall r > \frac{n}{2}$, there is a matching from $X^{(r)}$ to $X^{(r-1)}$.
  \end{enumerate}
  Then put these matchings together to form chains, each passing through $X^{(\floor{\frac{n}{2}})}$, so there are $\binom{n}{\floor{\frac{n}{2}}}$ of them. (Recall we have a \hyperlink{def:ints}{natural graph structure} on \hyperlink{def:qn}{$Q_n$})

  \begin{center}
    \begin{tikzpicture}
        \tikzfading[name=fade up, bottom color=transparent!0,
          top color=transparent!100]
        \tikzfading[name=fade down, bottom color=transparent!100,
          top color=transparent!0]
        \draw (0,3.2) circle [x radius=1mm, y radius=1mm];
        \node [right] at (0.25, 3.2) {$X^{(n)}$};

        \draw (0,2.7) circle [x radius=4.5mm, y radius=2mm];
        \node [right] at (0.5, 2.7) {$X^{(n-1)}$};

        \draw (0,1.9) circle [x radius=9mm, y radius=4mm];
        \node [right] at (0.9, 1.9) {$X^{(n-2)}$};

        \draw [bblue] (0,3.2) -- (0,2.7) -- (0,1.9);
        \draw [bblue, path fading=fade down] (0,1.9) -- (0,1.4);

        \draw [bblue] (0.2,2.7) to[out=270, in=100] (0.25,1.9);
        \draw [bblue, path fading=fade down] (0.25,1.9) to[out=-80, in=110] (0.4, 1.4);

        \draw [bblue] (-0.2,2.7) to[out=270, in=80] (-0.25,1.9);
        \draw [bblue, path fading=fade down] (-0.25,1.9) to[out=-100, in=70] (-0.4, 1.4);

        \draw [bblue, path fading=fade down] (0.5, 1.9) -- (0.7, 1.4);
        \draw [bblue, path fading=fade down] (-0.5, 1.9) -- (-0.7, 1.4);

        \node at (0,1.25) {$\vdots$};

        \foreach \val in {-1.4,-1.0,...,1.4} {
          \draw [bblue, path fading=fade up] (\val*0.8,1) to[in=90,out=270] (\val,0); % -- (\val*0.8,-1);
          \draw [bblue, path fading=fade down] (\val*0.8,-1) to[in=270,out=90] (\val,0);
        }

        \draw (0,0) circle [x radius=16mm, y radius=8mm];
        \node [right] at (1.6, 0) {$X^{(\floor{\frac{n}{2}})}$};

        \node at (0,-1.05) {$\vdots$};

        \begin{scope}[yscale=-1]
          \draw (0,3.2) circle [x radius=1mm, y radius=1mm];
          \node [right] at (0.25, 3.2) {$X^{(0)}$};

          \draw (0,2.7) circle [x radius=4.5mm, y radius=2mm];
          \node [right] at (0.5, 2.7) {$X^{(1)}$};

          \draw (0,1.9) circle [x radius=9mm, y radius=4mm];
          \node [right] at (0.9, 1.9) {$X^{(2)}$};

          \draw [bblue] (0,3.2) -- (0,2.7) -- (0,1.9);
          \draw [bblue, path fading=fade up] (0,1.9) -- (0,1.4);

          \draw [bblue] (0.2,2.7) to[out=270, in=100] (0.25,1.9);
          \draw [bblue, path fading=fade up] (0.25,1.9) to[out=-80, in=110] (0.4, 1.4);

          \draw [bblue] (-0.2,2.7) to[out=270, in=80] (-0.25,1.9);
          \draw [bblue, path fading=fade up] (-0.25,1.9) to[out=-100, in=70] (-0.4, 1.4);

          \draw [bblue, path fading=fade up] (0.5, 1.9) -- (0.7, 1.4);
          \draw [bblue, path fading=fade up] (-0.5, 1.9) -- (-0.7, 1.4);
        \end{scope}
    \end{tikzpicture}
  \end{center}

  By taking complements, it is sufficient to prove (i).

  Consider the subgraph of \hyperlink{def:qn}{$Q_n$} spanned by $\hyperlink{def:superr}{X^{(r)}} \cup X^{(r+1)}$. It is bipartite.
  For any $\mathcal{B} \subseteq X^{(r)}$, we have that
  \begin{itemize}
    \item The number of edges from $\mathcal{B}$ to $\Gamma(\mathcal{B})$ is $|\mathcal{B}| (n-r)$ (each point in $X^{(r)}$ has degree $n-r$).
    \item The number of edges from $\mathcal{B}$ to $\Gamma(\mathcal{B})$ is at most $|\Gamma(\mathcal{B})| (r+1)$ (each point in $X^{(r+1)}$ has degree $r+1$).
  \end{itemize}
  \begin{center}
    \begin{tikzpicture}
      \draw (0,1) circle [x radius=1.7cm, y radius=0.9cm];
      \node [right] at (1.7, 1) {$X^{(r+1)}$};
      \node [left, bred] at (0.1, 1.1) {$\Gamma(\mathcal{B})$};

      \draw (0, -1) circle [x radius=1.2cm, y radius=0.6cm];
      \node [right] at (1.2, -1) {$X^{(r)}$};
      \node [left, bred] at (0.3, -0.9) {$\mathcal{B}$};

      \begin{scope}[every path/.style={decorate, decoration={random steps, segment length=1.5pt, amplitude=0.7pt}, bred, fill=bred!20}]
        \draw (0.6, -0.9) circle [x radius=0.3cm, y radius=0.25cm];
        \draw (0.7, 1.1) circle [x radius=0.6cm, y radius=0.45cm];
      \end{scope}
      %\foreach \x in {0.4,0.5,...,1.1} {
      %  \draw [very thin] (\x,1.1) to (\x*0.6+0.2,-0.9);
      %}
    \end{tikzpicture}
  \end{center}
  Thus
  \begin{align*}
    |\Gamma(\mathcal{B})| &\geq |\mathcal{B}| \frac{n-r}{r+1} \\
                               &\geq |\mathcal{B}|
  \end{align*}
  as $r < \frac{n}{2}$.
  Hence by Hall's theorem, there is a matching.
\end{proof}

\begin{remark}
  Recall $\binom{n}{\floor{\frac{n}{2}}}$ was achievable, for example $\mathcal{A} = \hyperlink{def:superr}{X^{(\floor{\frac{n}{2}})}}$.
  This proof says nothing about extremal cases - which \hyperlink{def:antichain}{antichains} have size $\binom{n}{\floor{\frac{n}{2}}}$?
\end{remark}

Aim: For $\mathcal{A}$ an antichain,
\begin{equation*}
  \sum_{r=0}^n \frac{|\mathcal{A} \cap X^{(r)}|}{\binom{n}{r}} \leq 1.
\end{equation*}
This trivially implies \nameref{thm:sperner}.

\begin{defi}[Shadow]\index{shadow}\hypertarget{def:shadow}
  Let $\mathcal{A} \subseteq X^{(r)}$, for some $1 \leq r \leq n$.
  The \textbf{shadow} or \textbf{corner shadow} of $\mathcal{A}$ is
  \begin{equation*}
    \partial \mathcal{A} \equiv \partial^- \mathcal{A} \coloneqq \set{A - \{i\} | A \in \mathcal{A},\; i \in A}
  \end{equation*}
  so $\partial \mathcal{A} \subset X^{(r-1)}$.
\end{defi}
\begin{center}
  \begin{tikzpicture}
    \draw [bgreen, opacity=0.8] (0.2,1.1) -- (0.2,-1);
    \draw [bgreen, opacity=0.8] (1.2,1.1) -- (1,-1);

    \draw (0,1) circle [x radius=1.7cm, y radius=0.9cm];
    \node [right] at (1.7, 1) {$X^{(r)}$};
    \node [left, bgreen] at (0.2, 1.1) {$A$};

    \draw (0, -1) circle [x radius=1.2cm, y radius=0.6cm];
    \node [right] at (1.2, -1) {$X^{(r-1)}$};
    \node [left, bgreen] at (0.2, -1) {$\partial A$};
    \begin{scope}[every path/.style={decorate, decoration={random steps, segment length=1.5pt, amplitude=0.7pt}, bgreen, fill=bgreen!20}]
      \draw (0.6, -1) circle [x radius=0.4cm, y radius=0.3cm];
      \draw (0.7, 1.1) circle [x radius=0.5cm, y radius=0.4cm];
    \end{scope}
  \end{tikzpicture}
\end{center}
For example, if $\mathcal{A} = \{123,124,134,135\} \subset X^{(3)}$, then
\begin{equation*}\hyperlink{def:shadow}{\partial \mathcal{A}} = \{12,13,23,24,34,15,35\} \subset X^{(2)}.\end{equation*}

\begin{nlemma}[Local LYM]\label{thm:locallym}\index{Local LYM}
  Let $\mathcal{A} \subseteq \hyperlink{def:superr}{X^{(r)}}$, $1 \leq r \leq n$. Then
  \begin{equation*}
    \frac{|\hyperlink{def:shadow}{\partial \mathcal{A}}|}{\binom{n}{r-1}} \geq \frac{|\mathcal{A}|}{\binom{n}{r}}.
  \end{equation*}
  `The fraction of the layer occupied increases when we take the \hyperlink{def:shadow}{shadow}'.
\end{nlemma}
\begin{proof}
  Counting from above, there are $r|\mathcal{A}|$ edges $\mathcal{A}$ to $\hyperlink{def:shadow}{\partial \mathcal{A}}$.
  Counting from below, the number of edges $\mathcal{A}$ to $\partial \mathcal{A}$ is at most $(n-r+1) |\partial \mathcal{A}|$, so
  \begin{equation*}
    \frac{|\partial \mathcal{A}|}{|\mathcal{A}|} \geq \frac{r}{n-r+1}.
  \end{equation*}
  But
  \begin{equation*}
    \frac{\binom{n}{r-1}}{\binom{n}{r}} = \frac{r}{n-r+1}.\qedhere
  \end{equation*}
\end{proof}

When do we get equality in \nameref{thm:locallym}? We'd need $(A - \{i\}) \cup \{j\} \in \mathcal{A}\;\;\forall A \in \mathcal{A},\; i \in A,\; j \notin A$. Hence $\mathcal{A} = X^{r}$ or $\emptyset$.

The LYM in \nameref{thm:locallym} stands for `Lubell–Yamamoto–Meshalkin'.
We can use \nameref{thm:locallym} to prove:
\begin{nthm}[LYM]\label{thm:lym}\index{LYM}
  Let $\mathcal{A} \subset \mathcal{P}(X)$ be an \hyperlink{def:antichain}{antichain}.
  Then
  \begin{equation*}
    \sum_{r=0}^n \frac{|\mathcal{A} \cap \hyperlink{def:superr}{X^{(r)}}|}{\binom{n}{r}} \leq 1.
  \end{equation*}
\end{nthm}
\begin{proof}[Proof 1: `Bubble down with \nameref{thm:locallym}']
  Write $\mathcal{A}_r = \mathcal{A} \cap X^{(r)}$.
  We have $\frac{|\mathcal{A}_n|}{\binom{n}{n}} \leq 1$.
  Also, $\hyperlink{def:shadow}{\partial \mathcal{A}_n}$ and $\mathcal{A}_{n-1}$ are distinct since $\mathcal{A}$ was an \hyperlink{def:antichain}{antichain}, so
  \begin{align*}
    \frac{|\partial A_n|}{\binom{n}{n-1}} + \frac{|A_{n-1}|}{\binom{n}{n-1}} &= \frac{|\partial A_n \cup A_{n-1}|}{\binom{n}{n-1}} \\
    \implies \frac{|A_n|}{\binom{n}{n}} + \frac{|\mathcal{A}_{n-1}|}{\binom{n}{n-1}} &\leq 1
  \end{align*}
  by \nameref{thm:locallym}.

  Also, $\partial(\partial \mathcal{A}_n \cup \mathcal{A}_{n-1})$ is disjoint from $\mathcal{A}_{n-2}$, again since $\mathcal{A}$ is an antichain so
  \begin{align*}
    \frac{|\partial(\partial \mathcal{A}_n \cup \mathcal{A}_{n-1})|}{\binom{n}{n-2}} + \frac{\mathcal{A}_{n-2}}{{n \choose n-2}} &\leq 1, \\
    \implies \frac{|(\partial \mathcal{A}_n \cup \mathcal{A}_{n-1})|}{\binom{n}{n-1}} + \frac{\mathcal{A}_{n-2}}{{n \choose n-2}} &\leq 1, \\
    \implies \frac{\mathcal{A}_n}{\binom{n}{n}} + \frac{\mathcal{A}_{n-1}}{\binom{n}{n-1}} + \frac{\mathcal{A}_{n-2}}{\binom{n}{n-2}} &\leq 1.
  \end{align*}
  \begin{center}
    \begin{tikzpicture}[scale=2]
      \draw (0, 1) circle [x radius=0.5cm, y radius=0.3cm];
      \draw (0, 0) circle [x radius=0.9cm, y radius=0.5cm];
      \draw (0,-1.6) circle [x radius=1.4cm, y radius=0.8cm];

      \draw [bred, opacity=0.8] (-0.3, 1) -- (-0.6,0) -- (-0.1,-1.6);
      \draw [bred, opacity=0.8] (0.1, 1) -- (0,0);
      \draw [bred, opacity=0.8] (0.65,0) -- (0.9,-1.6);

      \node [bred] at (0.3,1) {$\mathcal{A}_n$};
      \node [bred] at (-0.3,-0.3) {$\partial \mathcal{A}_n$};
      \node [bred] at (0.3,-0.3) {$\mathcal{A}_{n-1}$};
      \node [bred] at (-0.7,-1.9) {$\mathcal{A}_{n-2}$};
      \node [bred] at (0.3,-2.1) {$\partial(\partial A_n \cup A_{n-1})$};

      \begin{scope}[every path/.style={decorate, decoration={random steps, segment length=1.5pt, amplitude=0.7pt}, bred, fill=bred!20}]
        \draw [thick] (-0.1, 1) circle [x radius=0.2 cm, y radius=1.5 mm];
        \draw [fill=bred!10] (-0.3, 0) circle [x radius=0.3 cm, y radius=0.2 cm];
        \draw [thick] (0.4, 0) circle [x radius=0.25 cm, y radius=0.2 cm];
        \draw [thick] (-0.7, -1.5) circle [x radius=0.3cm, y radius=0.25cm];
        \draw [fill=bred!10] (0.4, -1.6) circle [x radius=0.5cm, y radius=0.35cm];
      \end{scope}
    \end{tikzpicture}
  \end{center}
  Keep going, we obtain
  \begin{equation*}
    \frac{\mathcal{A}_n}{\binom{n}{n}} + \frac{\mathcal{A}_{n-1}}{\binom{n}{n-1}} + \dotsm + \frac{\mathcal{A}_0}{\binom{n}{0}} \leq 1. \qedhere
  \end{equation*}
\end{proof}

When do we get equality in \nameref{thm:lym}?
We must have had equality in each use of \nameref{thm:locallym}.
So the first (greatest) $r$ with $\mathcal{A}_r \neq \emptyset$ must have $\mathcal{A}_r = X^{(r)}$ thus $\mathcal{\mathcal{A}} = X^{(r)}$.
Hence equality in \nameref{thm:sperner} $\iff$ $\mathcal{A} = X^{(\frac{n}{2})}$ for $n$ even and $\mathcal{A} = X^{(\ihalf{n})}$ or $X^{(\ihalfc{n})}$ for $n$ odd.

% lecture 3
\begin{proof}[Proof 2]
  Choose uniformly at random a maximal \hyperlink{def:chain}{chain} $\mathcal{C}$ (i.e.\ $\mathcal{C}_0 \subset \mathcal{C}_1 \subset \mathcal{C}_2 \subset \dotsb \subset \mathcal{C}_n$) with $|\mathcal{C}_i| = i \; \forall i$.
  For a given \hyperlink{def:superr}{$r$-set} $A$,
 \begin{align*}\mathbb{P}(A \in \mathcal{C}) = &\frac{1}{\binom{n}{r}} \qquad \qquad \text{(all $r$-sets are equally likely)} \\
    \mathbb{P}(\mathcal{A}_r \text{ meets } \mathcal{C}) = &\frac{|\mathcal{A}_r|}{\binom{n}{r}} \qquad \qquad \text{(events are disjoint)} \\
    \implies \mathbb{P}(\mathcal{A} \text{ meets }\mathcal{C}) = &\sum_{r=0}^n \frac{|\mathcal{A}_r|}{\binom{n}{r}}. \\
    \implies &\sum_{i=0}^n \frac{|\mathcal{A}_r|}{\binom{n}{r}} \leq 1. \qedhere
  \end{align*}
\end{proof}
\begin{remark}
  Equivalently, the number of maximal chains is $n!$, and the number containing a given $r$-set is $r! (n-r)!$, so $\sum |\mathcal{A}_r| r! (n-r)! \leq n!$.
\end{remark}
\subsection{Shadows}
For $\mathcal{A} \subset X^{(r)}$, we know $|\partial A| \geq |A| \frac{r}{n-r+1}$ - but equality is rare (only for $\mathcal{A} = \emptyset$ or $\mathcal{A} = X^{(r)}$).

Given $|\mathcal{A}|$, how should we choose $\mathcal{A} \subset X^{(r)}$ to minimise $|\partial A|$?
(Ultimately, we are asking `how tightly can we pack some $r$-sets?')
If $|\mathcal{A}| = \binom{k}{r}$, it is believable that we'd take $\mathcal{A} = [k]^{(r)}$ - giving $\partial \mathcal{A} = [k]^{(r-1)}$.
What if $\binom{k}{r} < |\mathcal{A}| < \binom{k+1}{r}$? Believable that we'd take $[k]^{(r)}$ and some other $r$-sets from $[k+1]^{(r)}$.
For instance, if $\mathcal{A} \subset X^{(3)}$ with $|\mathcal{A}| = \binom{7}{3} + \binom{4}{2}$, we'd take $\mathcal{A} = [7]^{(3)} \cup \set{A \cup \{8\} | A\in [4]^{(2)}}$

\subsubsection{Two total orderings on \texorpdfstring{$X^{(r)}$}{X(r)}}
Given $A,B \in \hyperlink{def:superr}{X^{(r)}}$, say $A = a_1 \dotsb a_r$, $B = b_1 \dotsb b_r$.
\begin{defi}[Lexicographic order]\index{lexicographic order}\hypertarget{def:lex}
  Say $A < B$ in the \textbf{lexicographic order} or \textbf{lex order} if for some $i$ we have $a_i < b_i$ and $a_j = b_j \; \forall j < i$.
\end{defi}
Equivalently, $a_i < b_i$, where $i = \min\set{j | a_j \neq b_j}$.
`Use small numbers', dictionary order.

\begin{eg}\leavevmode
  \begin{itemize}
    \item The \hyperlink{def:lex}{lex order} on $\hyperlink{def:ints}{[4]}^{\hyperlink{def:superr}{(2)}}$ is
      \begin{equation*}
        12,13,14,23,24,34.
      \end{equation*}
    \item The lex order on $[6]^{(3)}$ is
      \begin{align*}
        &123,124,125,126,134,135,136,145,146,156,\\
        &234,235,236,245,246,256,345,346,356,456.
      \end{align*}
  \end{itemize}
\end{eg}

\begin{defi}[Colexicographic order]\index{colexicographic order}\hypertarget{def:colex}
  Say $A < B$ in the \textbf{colexicographic order} or \textbf{colex order} if for some $i$ have $a_i < b_i$ and $a_j = b_j \; \forall j > i$.
\end{defi}
Equivalently, $a_i < b_i$ where $i = \max\set{j | a_j \neq b_j}$.
`Avoid large numbers'. Equivalently, $A < B$ if $\sum_{i \in A} 2^i < \sum_{i \in B} 2^i$.
\begin{eg}\leavevmode
  \begin{itemize}
    \item \hyperlink{def:colex}{Colex} on $\hyperlink{def:ints}{[4]}^{\hyperlink{def:superr}{(2)}}$ is
      \begin{equation*}
        12,13,23,14,24,34
      \end{equation*}
    \item Colex on $[6]^{(3)}$ is
      \begin{align*}
        &123,124,134,234,125,135,235,145,245,345,\\
        &126,136,236,146,246,346,156,256,356,456.
      \end{align*}
  \end{itemize}
\end{eg}
Note: In \hyperlink{def:colex}{colex}, $\hyperlink{def:ints}{[k]}^{\hyperlink{def:superr}{(r)}}$ is an initial segment of $[k+1]^{(r+1)}$, so we could view colex as an enumeration of $\mathbb{N}^{(r)}$ (but this is false for \hyperlink{def:lex}{lex}).

\begin{aim}
  Initial segments of \hyperlink{def:colex}{colex} minimise $\hyperlink{def:shadow}{\partial}$, i.e.\ if $\mathcal{A} \subset \hyperlink{def:superr}{X^{(r)}}$ and $\mathcal{C} \subset X^{(r)}$ is the first $|\mathcal{A}|$ $r$-sets in \hyperlink{def:colex}{colex}, then $|\partial \mathcal{A}| \geq |\partial \mathcal{C}|$.
\end{aim}
This is known as the Kruskal-Katona theorem.
In particular, \begin{equation*}|\mathcal{A}| = \binom{k}{r} \implies |\partial A| \geq \binom{k}{r-1}.\end{equation*}

\subsection{Compressions}
Idea: We want to `replace' $\mathcal{A} \subset X^{(r)}$ with some $\mathcal{A}' \subset X^{(r)}$ such that
\begin{enumerate}[label=(\roman*)]
  \item $|\mathcal{A}'| = |\mathcal{A}|$
  \item $|\partial \mathcal{A}'| \leq |\partial \mathcal{A}|$
  \item $\mathcal{A}'$ `looks more like $\mathcal{C}$' than $\mathcal{A}$ did.
\end{enumerate}
Ideally, we'd compress $\mathcal{A} \to \mathcal{A}' \to \mathcal{A}'' \to \dotsm \to \mathcal{B}$ where either $\mathcal{B} = \mathcal{C}$ or $\mathcal{B}$ is so similar to $\mathcal{C}$ that we can see directly that $|\partial \mathcal{B}| \geq |\partial \mathcal{C}|$.

\clearpage
\section{Isoperimetric inequalities}
\section{Projections}
\printindex
\end{document}
