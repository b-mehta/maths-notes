\documentclass{article}

\def\npart{III}
\def\nyear{2018}
\def\nterm{Michaelmas}
\def\nlecturer{Professor I.\ B.\ Leader}
\def\ncourse{Combinatorics}
\def\draft{Ongoing course, rough}
\usepackage{imakeidx}
\usepackage{chngcntr}
\usepackage{marginnote}
\input{header}
\makeindex[intoc]
\usetikzlibrary{fadings, decorations.pathmorphing}

% preamble

\setcounter{section}{-1}
\counterwithout{nthm}{section}

\reversemarginpar

\DeclarePairedDelimiter\ceil{\lceil}{\rceil}
\DeclarePairedDelimiter\floor{\lfloor}{\rfloor}

\newcommand{\ihalf}[1]{\floor{\frac{#1}{2}}}
\newcommand{\ihalfc}[1]{\ceil{\frac{#1}{2}}}
\newcommand{\A}{\mathcal{A}}
\newcommand{\named}[1]{\textbf{#1}\index{#1}}

%\newtheorem{manualtheoreminner}{Theorem}
%\newenvironment{manualtheorem}[1]{%
%    \renewcommand\themanualtheoreminner{#1}%
%    \manualtheoreminner
%}{\endmanualtheoreminner}

% and here we go!

\let\oldsubset\subset
\let\subset\subseteq

\begin{document}
\maketitle

\tableofcontents

\clearpage
\section{Introduction}
\marginnote{\emph{Lecture 1}}[0cm]
Combinatorics tends to have problems which are easy to state and hard to prove.
One of the reasons for this is that it is often unclear where to start - for instance in linear algebra we can often start by picking a basis.
Proofs tend to have the property that they seem to take thousands of years to come up with, and a single line to write down.
In this course, we learn some techniques which make problems sounding very hard become very easy.

We start with set systems, which builds on the idea of subsets and containment.
Next, we study isoperimetric inequalities.
In the continuous case, in the plane, a typical problem is to find the maximum area one can enclose with a fixed perimeter, which is solved by a circle.
Similarly, a soap bubble will minimise its surface area for a fixed volume.
Here, in the discrete case, we will try to understand `how tightly' we can pack subsets.
Finally, we look at continuous projections.
For instance, given a subset of space, suppose we know the $z$-coordinate of all points is between $0$ and $1$, and the projection to the $xy$-plane has area $A$, we know the total volume is bounded by $A$.
We generalise this result into higher dimensions and the box result, which has applications in combinatorics.

While all examinable proofs will be included in lectures, relevant books for this course are:
\begin{enumerate}
  \item \emph{Combinatorics}, Bollob\'{a}s, C.U.P., 1996. This matches chapter 1 excellently and parts of chapter 2. It is a gentle read and includes other developments in combinatorics.
  \item \emph{Combinatorics of finite sets}, Anderson, O.U.P., 1987. It is a simple and clear study on chapter 1.
\end{enumerate}

\clearpage
\section{Set systems}
\begin{defi}[Set system]\index{set system}\hypertarget{def:ss}
  Let $X$ be a set. A \named{set system} on $X$ (or \named{family of subsets} of $X$) is a family $\mathcal{A} \subseteq \mathcal{P}(X)$.
\end{defi}
For instance, we write \hypertarget{def:superr}$X^{(r)} = \set{A \subset X | |A| = r}$, so $X^{(r)}$ is a \hyperlink{def:ss}{set system} on $X$.
Unless otherwise stated,
\begin{equation*}
  \hypertarget{def:ints}X = [n] \coloneqq \{1,2,\dotsc,n\},
\end{equation*}
e.g.\ $|X^{\hyperlink{def:superr}{(r)}}| = \binom{n}{r}$.
Thus $\hyperlink{def:ints}{[4]}^{(2)} = \{12,13,14,23,24,34\}$, so $|[4]^{(2)}| = 6$.

Often, we make $\mathcal{P}(X)$ into a graph, called $Q_n$, by joining $A$ to $B$ if $|A \triangle B| = 1$, i.e.\ if $A = B \cup \{i\}$ for some $i \notin B$ (or vice versa).
For instance, here is a picture of $Q_3$:
\begin{center}
  \begin{tikzpicture}[xscale=1.4, every node/.style={fill=black, circle, inner sep=1pt}]
    \node [label=below:$\emptyset$] (empty) at (0,0) {};
    \node [label=left:$1$] (1) at (-1,1) {};
    \node [label=below right:$2$] (2) at (0,1) {};
    \node [label=right:$3$] (3) at (1,1) {};
    \node [label=left:$23$] (23) at (-1,2) {};
    \node [label=above right:$13$] (13) at (0,2) {};
    \node [label=right:$12$] (12) at (1,2) {};
    \node [label=above:$123$] (123) at (0,3) {};
    \draw (empty) -- (1);
    \draw (empty) -- (2);
    \draw (empty) -- (3);
    \draw (1) -- (12);
    \draw (1) -- (13);
    \draw (2) -- (12);
    \draw (2) -- (23);
    \draw (3) -- (13);
    \draw (3) -- (23);
    \draw (12) -- (123);
    \draw (13) -- (123);
    \draw (23) -- (123);
  \end{tikzpicture}
\end{center}

As we know, the picture gets `thicker' in the middle. But, for odd $n$, is it not clear where exactly the middle is, so in the odd case we have two equally sized large blobs in the middle.

\begin{center}
  \begin{tikzpicture}
    \begin{scope}
      \node at (-2, 3) {$Q_n$, $n$ even};

      \draw (0,3.2) circle [x radius=1mm, y radius=1mm];
      \node [right] at (0.25, 3.2) {$\hyperlink{def:superr}{X^{(n)}}$};

      \draw (0,2.7) circle [x radius=4.5mm, y radius=2mm];
      \node [right] at (0.5, 2.7) {$X^{(n-1)}$};

      \draw (0,1.9) circle [x radius=9mm, y radius=4mm];
      \node [right] at (0.9, 1.9) {$X^{(n-2)}$};

      \node at (0,1.25) {$\vdots$};

      \draw (0,0) circle [x radius=16mm, y radius=8mm];
      \node [right] at (1.6, 0) {$X^{(\frac{n}{2})}$};

      \node at (0,-1.05) {$\vdots$};

      \draw (0,-1.9) circle [x radius=9mm, y radius=4mm];
      \node [right] at (0.9, -1.9) {$X^{(2)}$};

      \draw (0,-2.7) circle [x radius=4.5mm, y radius=2mm];
      \node [right] at (0.5, -2.7) {$X^{(1)}$};

      \draw (0,-3.2) circle [x radius=1mm, y radius=1mm];
      \node [right] at (0.25, -3.2) {$X^{(0)}$};
    \end{scope}

    \begin{scope}[xshift=6cm]
      \node at (-2, 3) {$Q_n$, $n$ odd};

      \draw (0,3.2) circle [x radius=1mm, y radius=0.8mm];
      \node [right] at (0.25, 3.2) {$X^{(n)}$};

      \draw (0,2.8) circle [x radius=4.5mm, y radius=1.5mm];
      \node [right] at (0.5, 2.8) {$X^{(n-1)}$};

      \draw (0,2.1) circle [x radius=9mm, y radius=3mm];
      \node [right] at (0.9, 2.1) {$X^{(n-2)}$};

      \node at (0,1.55) {$\vdots$};

      \draw (0,0.6) circle [x radius=16mm, y radius=5mm];
      \node [right] at (1.6, 0.6) {$X^{(\ceil{\frac{n}{2}})}$};

      \draw (0,-0.6) circle [x radius=16mm, y radius=5mm];
      \node [right] at (1.6, -0.6) {$X^{(\floor{\frac{n}{2}})}$};

      \node at (0,-1.35) {$\vdots$};

      \draw (0,-2.1) circle [x radius=9mm, y radius=3mm];
      \node [right] at (0.9, -2.1) {$X^{(2)}$};

      \draw (0,-2.8) circle [x radius=4.5mm, y radius=1.5mm];
      \node [right] at (0.5, -2.8) {$X^{(1)}$};

      \draw (0,-3.2) circle [x radius=1mm, y radius=0.8mm];
      \node [right] at (0.25, -3.2) {$X^{(0)}$};
    \end{scope}
  \end{tikzpicture}
\end{center}

If we identify a set $A \subseteq X$ with a $0$-$1$ sequence of length $n$, e.g.\ $134 \longleftrightarrow 1011000\dots0$, via $A \longleftrightarrow 1_{A}$ or $\chi_A$, the characteristic function,
then $Q_3$ looks like
\begin{center}
  \begin{tikzpicture}[every node/.style={fill=black, circle, inner sep=1pt}, scale=2.5]
    \node [label=below left:$\emptyset$] (empty) at (0,0) {};
    \node [label=below right:$1$] (1) at (1, 0) {};
    \node [fill opacity=0.5, label=left:$2$] (2) at (0.3,0.3) {};
    \node [label=left:$3$] (3) at (0, 1) {};
    \node [label=above left:$13$] (13) at (1, 1) {};
    \node [label=right:$12$] (12) at (1.3, 0.3) {};
    \node [label=above left:$23$] (23) at (0.3, 1.3) {};
    \node [label=above right:$123$] (123) at (1.3, 1.3) {};
    \draw (empty) -- (1);
    \draw [opacity=0.7, very thin] (empty) -- (2);
    \draw (empty) -- (3);
    \draw (1) -- (12);
    \draw (1) -- (13);
    \draw [opacity=0.7, very thin] (2) -- (12);
    \draw [opacity=0.7, very thin] (2) -- (23);
    \draw (3) -- (13);
    \draw (3) -- (23);
    \draw (12) -- (123);
    \draw (13) -- (123);
    \draw (23) -- (123);
  \end{tikzpicture}
\end{center}
\begin{defi}[Hypercube]\index{hypercube}\hypertarget{def:qn}
  $Q_n$ is often called the \named{hypercube} or \textbf{discrete cube} or \textbf{$n$-cube}.
\end{defi}
It is important to keep \emph{both} these pictures in mind: for induction the cube image is more instructive, but when thinking about layers the earlier image is more helpful.

\subsection{Chains and antichains}
\begin{defi}[Chain]\index{chain}\hypertarget{def:chain}
  A family $\mathcal{A} \subseteq \mathcal{P}(X)$ is a \named{chain} if $\forall A, B \in \mathcal{A}$, we have $A \subseteq B$ or $B \subseteq A$.
\end{defi}
\begin{defi}[Antichain]\index{antichain}\hypertarget{def:antichain}
  A family $\mathcal{A} \subseteq \mathcal{P}(X)$ is an \named{antichain} if $\forall A,B \in \mathcal{A}$ with $A \neq B \Rightarrow A \nsubseteq B$.
\end{defi}
\begin{eg}
  For instance, $\{12, 125, 123589\}$ is an \hyperlink{def:chain}{chain}, and $\{1,467,2456\}$ is an \hyperlink{def:antichain}{antichain}.
\end{eg}

In this course, we ask questions like, how large can a \hyperlink{def:chain}{chain} be?
We can achieve $|\mathcal{A}| = n+1$, e.g.\ $\{\emptyset, 1, 12, 123, \dotsc, [n]\}$.
It is easy to visualise this by picking `one per level':
\begin{center}
  \begin{tikzpicture}
      \draw (0,3.2) circle [x radius=1mm, y radius=1mm];
      \draw (0,2.7) circle [x radius=4.5mm, y radius=2mm];
      \draw (0,1.9) circle [x radius=9mm, y radius=4mm];
      \node at (0,1.25) {$\vdots$};
      \draw (0,0) circle [x radius=16mm, y radius=8mm];
      \node at (0,-1.05) {$\vdots$};
      \draw (0,-1.9) circle [x radius=9mm, y radius=4mm];
      \draw (0,-2.7) circle [x radius=4.5mm, y radius=2mm];
      \draw (0,-3.2) circle [x radius=1mm, y radius=1mm];
      \begin{scope}[every node/.style={fill=black, circle, inner sep=0.5pt}]
        \node (0) at (0,-3.2)    {};
        \node (1) at (0.1,-2.7)  {};
        \node (2) at (-0.2,-1.8) {};
        \node (3) at (0.3, 0.1)   {};
        \node (4) at (0.2,1.8)   {};
        \node (5) at (-0.1,2.7)  {};
        \node (6) at (0,3.2)     {};
        \draw[very thin, gray] (0) -- (1) -- (2) -- (3) -- (4) -- (5) -- (6);
      \end{scope}
  \end{tikzpicture}
\end{center}

We cannot exceed $n+1$, since a chain must meet each `level' $X^{(r)}$ ($0 \leq r \leq n$) in at most one place.

How large can an \hyperlink{def:antichain}{antichain} be?
We could achieve $\mathcal{A}=n$, e.g.\ $\mathcal{A} = \{1,2,3,\dotsc,n\}$ (and this is maximal).
Indeed, we could take $\mathcal{A} = X^{(r)}$ for any $r$, so we can achieve $|\mathcal{A}| = \binom{n}{\floor{\frac{n}{2}}}$.
Can we beat this?
Aim: Prove this is the winner.

\marginnote{\emph{Lecture 2}}[0cm]
Inspired by `each \hyperlink{def:chain}{chain} meets each level $X^{(r)}$ in at most one place' for chains, we try to decompose $\hyperlink{def:qn}{Q_n}$ into chains to find large \hyperlink{def:antichain}{antichains}.
\begin{nthm}[Sperner's Lemma]\label{thm:sperner1}\index{Sperner's Lemma}
  Let $\mathcal{A} \subseteq \mathcal{P}(X)$ be an \hyperlink{def:antichain}{antichain}.
  Then $|\mathcal{A}| \leq \binom{n}{\floor{\frac{n}{2}}}$.
\end{nthm}
\begin{proof}
  It is sufficient to partition $\mathcal{P}(X)$ into $\binom{n}{\floor{\frac{n}{2}}}$ \hyperlink{def:chain}{chains}.
  For this, it is sufficient to show
  \begin{enumerate}[label=(\roman*)]
    \item $\forall r < \frac{n}{2}$, there is a matching from \hyperlink{def:superr}{$X^{(r)}$} to $X^{(r+1)}$
    \item $\forall r > \frac{n}{2}$, there is a matching from $X^{(r)}$ to $X^{(r-1)}$.
  \end{enumerate}
  Then put these matchings together to form chains, each passing through $X^{(\floor{\frac{n}{2}})}$, so there are $\binom{n}{\floor{\frac{n}{2}}}$ of them. (Recall we have a \hyperlink{def:ints}{natural graph structure} on \hyperlink{def:qn}{$Q_n$})

  \begin{center}
    \begin{tikzpicture}
        \tikzfading[name=fade up, bottom color=transparent!0,
          top color=transparent!100]
        \tikzfading[name=fade down, bottom color=transparent!100,
          top color=transparent!0]
        \draw (0,3.2) circle [x radius=1mm, y radius=1mm];
        \node [right] at (0.25, 3.2) {$X^{(n)}$};

        \draw (0,2.7) circle [x radius=4.5mm, y radius=2mm];
        \node [right] at (0.5, 2.7) {$X^{(n-1)}$};

        \draw (0,1.9) circle [x radius=9mm, y radius=4mm];
        \node [right] at (0.9, 1.9) {$X^{(n-2)}$};

        \draw [bblue] (0,3.2) -- (0,2.7) -- (0,1.9);
        \draw [bblue, path fading=fade down] (0,1.9) -- (0,1.4);

        \draw [bblue] (0.2,2.7) to[out=270, in=100] (0.25,1.9);
        \draw [bblue, path fading=fade down] (0.25,1.9) to[out=-80, in=110] (0.4, 1.4);

        \draw [bblue] (-0.2,2.7) to[out=270, in=80] (-0.25,1.9);
        \draw [bblue, path fading=fade down] (-0.25,1.9) to[out=-100, in=70] (-0.4, 1.4);

        \draw [bblue, path fading=fade down] (0.5, 1.9) -- (0.7, 1.4);
        \draw [bblue, path fading=fade down] (-0.5, 1.9) -- (-0.7, 1.4);

        \node at (0,1.25) {$\vdots$};

        \foreach \val in {-1.4,-1.0,...,1.4} {
          \draw [bblue, path fading=fade up] (\val*0.8,1) to[in=90,out=270] (\val,0); % -- (\val*0.8,-1);
          \draw [bblue, path fading=fade down] (\val*0.8,-1) to[in=270,out=90] (\val,0);
        }

        \draw (0,0) circle [x radius=16mm, y radius=8mm];
        \node [right] at (1.6, 0) {$X^{(\floor{\frac{n}{2}})}$};

        \node at (0,-1.05) {$\vdots$};

        \begin{scope}[yscale=-1]
          \draw (0,3.2) circle [x radius=1mm, y radius=1mm];
          \node [right] at (0.25, 3.2) {$X^{(0)}$};

          \draw (0,2.7) circle [x radius=4.5mm, y radius=2mm];
          \node [right] at (0.5, 2.7) {$X^{(1)}$};

          \draw (0,1.9) circle [x radius=9mm, y radius=4mm];
          \node [right] at (0.9, 1.9) {$X^{(2)}$};

          \draw [bblue] (0,3.2) -- (0,2.7) -- (0,1.9);
          \draw [bblue, path fading=fade up] (0,1.9) -- (0,1.4);

          \draw [bblue] (0.2,2.7) to[out=270, in=100] (0.25,1.9);
          \draw [bblue, path fading=fade up] (0.25,1.9) to[out=-80, in=110] (0.4, 1.4);

          \draw [bblue] (-0.2,2.7) to[out=270, in=80] (-0.25,1.9);
          \draw [bblue, path fading=fade up] (-0.25,1.9) to[out=-100, in=70] (-0.4, 1.4);

          \draw [bblue, path fading=fade up] (0.5, 1.9) -- (0.7, 1.4);
          \draw [bblue, path fading=fade up] (-0.5, 1.9) -- (-0.7, 1.4);
        \end{scope}
    \end{tikzpicture}
  \end{center}

  By taking complements, it is sufficient to prove (i).

  Consider the subgraph of \hyperlink{def:qn}{$Q_n$} spanned by $\hyperlink{def:superr}{X^{(r)}} \cup X^{(r+1)}$. It is bipartite.
  For any $\mathcal{B} \subseteq X^{(r)}$, we have that
  \begin{itemize}
    \item The number of edges from $\mathcal{B}$ to $\Gamma(\mathcal{B})$ is $|\mathcal{B}| (n-r)$ (each point in $X^{(r)}$ has degree $n-r$).
    \item The number of edges from $\mathcal{B}$ to $\Gamma(\mathcal{B})$ is at most $|\Gamma(\mathcal{B})| (r+1)$ (each point in $X^{(r+1)}$ has degree $r+1$).
  \end{itemize}
  \begin{center}
    \begin{tikzpicture}
      \draw (0,1) circle [x radius=1.7cm, y radius=0.9cm];
      \node [right] at (1.7, 1) {$X^{(r+1)}$};
      \node [left, bred] at (0.1, 1.1) {$\Gamma(\mathcal{B})$};

      \draw (0, -1) circle [x radius=1.2cm, y radius=0.6cm];
      \node [right] at (1.2, -1) {$X^{(r)}$};
      \node [left, bred] at (0.3, -0.9) {$\mathcal{B}$};

      \begin{scope}[every path/.style={decorate, decoration={random steps, segment length=1.5pt, amplitude=0.7pt}, bred, fill=bred!20}]
        \draw (0.6, -0.9) circle [x radius=0.3cm, y radius=0.25cm];
        \draw (0.7, 1.1) circle [x radius=0.6cm, y radius=0.45cm];
      \end{scope}
      %\foreach \x in {0.4,0.5,...,1.1} {
      %  \draw [very thin] (\x,1.1) to (\x*0.6+0.2,-0.9);
      %}
    \end{tikzpicture}
  \end{center}
  Thus
  \begin{align*}
    |\Gamma(\mathcal{B})| &\geq |\mathcal{B}| \frac{n-r}{r+1} \\
                               &\geq |\mathcal{B}|
  \end{align*}
  as $r < \frac{n}{2}$.
  Hence by Hall's theorem, there is a matching.
\end{proof}

\begin{remark}
  Recall $\binom{n}{\floor{\frac{n}{2}}}$ was achievable, for example $\mathcal{A} = \hyperlink{def:superr}{X^{(\floor{\frac{n}{2}})}}$.
  This proof says nothing about extremal cases - which \hyperlink{def:antichain}{antichains} have size $\binom{n}{\floor{\frac{n}{2}}}$?
\end{remark}

Aim: For $\mathcal{A}$ an antichain,
\begin{equation*}
  \sum_{r=0}^n \frac{|\mathcal{A} \cap X^{(r)}|}{\binom{n}{r}} \leq 1.
\end{equation*}
This trivially implies \nameref{thm:sperner1}.

\begin{defi}[Shadow]\index{shadow}\hypertarget{def:shadow}
  Let $\mathcal{A} \subseteq X^{(r)}$, for some $1 \leq r \leq n$.
  The \named{shadow} or \named{corner shadow} of $\mathcal{A}$ is
  \begin{equation*}
    \partial \mathcal{A} \equiv \partial^- \mathcal{A} \coloneqq \set{A - \{i\} | A \in \mathcal{A},\; i \in A}
  \end{equation*}
  so $\partial \mathcal{A} \subset X^{(r-1)}$.
\end{defi}
\begin{center}
  \begin{tikzpicture}
    \draw [bgreen, opacity=0.8] (0.2,1.1) -- (0.2,-1);
    \draw [bgreen, opacity=0.8] (1.2,1.1) -- (1,-1);

    \draw (0,1) circle [x radius=1.7cm, y radius=0.9cm];
    \node [right] at (1.7, 1) {$X^{(r)}$};
    \node [left, bgreen] at (0.2, 1.1) {$A$};

    \draw (0, -1) circle [x radius=1.2cm, y radius=0.6cm];
    \node [right] at (1.2, -1) {$X^{(r-1)}$};
    \node [left, bgreen] at (0.2, -1) {$\partial A$};
    \begin{scope}[every path/.style={decorate, decoration={random steps, segment length=1.5pt, amplitude=0.7pt}, bgreen, fill=bgreen!20}]
      \draw (0.6, -1) circle [x radius=0.4cm, y radius=0.3cm];
      \draw (0.7, 1.1) circle [x radius=0.5cm, y radius=0.4cm];
    \end{scope}
  \end{tikzpicture}
\end{center}
For example, if $\mathcal{A} = \{123,124,134,135\} \subset X^{(3)}$, then
\begin{equation*}\hyperlink{def:shadow}{\partial \mathcal{A}} = \{12,13,23,24,34,15,35\} \subset X^{(2)}.\end{equation*}

\begin{nlemma}[Local LYM]\label{thm:locallym2}\index{Local LYM}
  Let $\mathcal{A} \subseteq \hyperlink{def:superr}{X^{(r)}}$, $1 \leq r \leq n$. Then
  \begin{equation*}
    \frac{|\hyperlink{def:shadow}{\partial \mathcal{A}}|}{\binom{n}{r-1}} \geq \frac{|\mathcal{A}|}{\binom{n}{r}}.
  \end{equation*}
  `The fraction of the layer occupied increases when we take the \hyperlink{def:shadow}{shadow}'.
\end{nlemma}
\begin{proof}
  Counting from above, there are $r|\mathcal{A}|$ edges $\mathcal{A}$ to $\hyperlink{def:shadow}{\partial \mathcal{A}}$.
  Counting from below, the number of edges $\mathcal{A}$ to $\partial \mathcal{A}$ is at most $(n-r+1) |\partial \mathcal{A}|$, so
  \begin{equation*}
    \frac{|\partial \mathcal{A}|}{|\mathcal{A}|} \geq \frac{r}{n-r+1}.
  \end{equation*}
  But
  \begin{equation*}
    \frac{\binom{n}{r-1}}{\binom{n}{r}} = \frac{r}{n-r+1}.\qedhere
  \end{equation*}
\end{proof}

When do we get equality in \nameref{thm:locallym2}? We'd need $(A - \{i\}) \cup \{j\} \in \mathcal{A}\;\;\forall A \in \mathcal{A},\; i \in A,\; j \notin A$. Hence $\mathcal{A} = X^{r}$ or $\emptyset$.

The LYM in \nameref{thm:locallym2} stands for `Lubell–Yamamoto–Meshalkin'.
We can use \nameref{thm:locallym2} to prove:
\begin{nthm}[LYM]\label{thm:lym3}\index{LYM}
  Let $\mathcal{A} \subset \mathcal{P}(X)$ be an \hyperlink{def:antichain}{antichain}.
  Then
  \begin{equation*}
    \sum_{r=0}^n \frac{|\mathcal{A} \cap \hyperlink{def:superr}{X^{(r)}}|}{\binom{n}{r}} \leq 1.
  \end{equation*}
\end{nthm}
\begin{proof}[Proof 1: `Bubble down with \nameref{thm:locallym2}']
  Write $\mathcal{A}_r = \mathcal{A} \cap X^{(r)}$.
  We have $\frac{|\mathcal{A}_n|}{\binom{n}{n}} \leq 1$.
  Also, $\hyperlink{def:shadow}{\partial \mathcal{A}_n}$ and $\mathcal{A}_{n-1}$ are distinct since $\mathcal{A}$ was an \hyperlink{def:antichain}{antichain}, so
  \begin{align*}
    \frac{|\partial A_n|}{\binom{n}{n-1}} + \frac{|A_{n-1}|}{\binom{n}{n-1}} &= \frac{|\partial A_n \cup A_{n-1}|}{\binom{n}{n-1}} \\
    \implies \frac{|A_n|}{\binom{n}{n}} + \frac{|\mathcal{A}_{n-1}|}{\binom{n}{n-1}} &\leq 1
  \end{align*}
  by \nameref{thm:locallym2}.

  Also, $\partial(\partial \mathcal{A}_n \cup \mathcal{A}_{n-1})$ is disjoint from $\mathcal{A}_{n-2}$, again since $\mathcal{A}$ is an antichain so
  \begin{align*}
    \frac{|\partial(\partial \mathcal{A}_n \cup \mathcal{A}_{n-1})|}{\binom{n}{n-2}} + \frac{\mathcal{A}_{n-2}}{{n \choose n-2}} &\leq 1, \\
    \implies \frac{|(\partial \mathcal{A}_n \cup \mathcal{A}_{n-1})|}{\binom{n}{n-1}} + \frac{\mathcal{A}_{n-2}}{{n \choose n-2}} &\leq 1, \\
    \implies \frac{\mathcal{A}_n}{\binom{n}{n}} + \frac{\mathcal{A}_{n-1}}{\binom{n}{n-1}} + \frac{\mathcal{A}_{n-2}}{\binom{n}{n-2}} &\leq 1.
  \end{align*}
  \begin{center}
    \begin{tikzpicture}[scale=2]
      \draw (0, 1) circle [x radius=0.5cm, y radius=0.3cm];
      \draw (0, 0) circle [x radius=0.9cm, y radius=0.5cm];
      \draw (0,-1.6) circle [x radius=1.4cm, y radius=0.8cm];

      \draw [bred, opacity=0.8] (-0.3, 1) -- (-0.6,0) -- (-0.1,-1.6);
      \draw [bred, opacity=0.8] (0.1, 1) -- (0,0);
      \draw [bred, opacity=0.8] (0.65,0) -- (0.9,-1.6);

      \node [bred] at (0.3,1) {$\mathcal{A}_n$};
      \node [bred] at (-0.3,-0.3) {$\partial \mathcal{A}_n$};
      \node [bred] at (0.3,-0.3) {$\mathcal{A}_{n-1}$};
      \node [bred] at (-0.7,-1.9) {$\mathcal{A}_{n-2}$};
      \node [bred] at (0.3,-2.1) {$\partial(\partial A_n \cup A_{n-1})$};

      \begin{scope}[every path/.style={decorate, decoration={random steps, segment length=1.5pt, amplitude=0.7pt}, bred, fill=bred!20}]
        \draw [thick] (-0.1, 1) circle [x radius=0.2 cm, y radius=1.5 mm];
        \draw [fill=bred!10] (-0.3, 0) circle [x radius=0.3 cm, y radius=0.2 cm];
        \draw [thick] (0.4, 0) circle [x radius=0.25 cm, y radius=0.2 cm];
        \draw [thick] (-0.7, -1.5) circle [x radius=0.3cm, y radius=0.25cm];
        \draw [fill=bred!10] (0.4, -1.6) circle [x radius=0.5cm, y radius=0.35cm];
      \end{scope}
    \end{tikzpicture}
  \end{center}
  Keep going, we obtain
  \begin{equation*}
    \frac{\mathcal{A}_n}{\binom{n}{n}} + \frac{\mathcal{A}_{n-1}}{\binom{n}{n-1}} + \dotsm + \frac{\mathcal{A}_0}{\binom{n}{0}} \leq 1. \qedhere
  \end{equation*}
\end{proof}

When do we get equality in \nameref{thm:lym3}?
We must have had equality in each use of \nameref{thm:locallym2}.
So the first (greatest) $r$ with $\mathcal{A}_r \neq \emptyset$ must have $\mathcal{A}_r = X^{(r)}$ thus $\mathcal{\mathcal{A}} = X^{(r)}$.
Hence equality in \nameref{thm:sperner1} $\iff$ $\mathcal{A} = X^{(\frac{n}{2})}$ for $n$ even and $\mathcal{A} = X^{(\ihalf{n})}$ or $X^{(\ihalfc{n})}$ for $n$ odd.

\marginnote{\emph{Lecture 3}}[0cm]
\begin{proof}[Proof 2]
  Choose uniformly at random a maximal \hyperlink{def:chain}{chain} $\mathcal{C}$ (i.e.\ $\mathcal{C}_0 \subset \mathcal{C}_1 \subset \mathcal{C}_2 \subset \dotsb \subset \mathcal{C}_n$) with $|\mathcal{C}_i| = i \; \forall i$.
  For a given \hyperlink{def:superr}{$r$-set} $A$,
 \begin{align*}\mathbb{P}(A \in \mathcal{C}) = &\frac{1}{\binom{n}{r}} \qquad \qquad \text{(all $r$-sets are equally likely)} \\
    \mathbb{P}(\mathcal{A}_r \text{ meets } \mathcal{C}) = &\frac{|\mathcal{A}_r|}{\binom{n}{r}} \qquad \qquad \text{(events are disjoint)} \\
    \implies \mathbb{P}(\mathcal{A} \text{ meets }\mathcal{C}) = &\sum_{r=0}^n \frac{|\mathcal{A}_r|}{\binom{n}{r}}. \\
    \implies &\sum_{i=0}^n \frac{|\mathcal{A}_r|}{\binom{n}{r}} \leq 1. \qedhere
  \end{align*}
\end{proof}
\begin{remark}
  Equivalently, the number of maximal chains is $n!$, and the number containing a given $r$-set is $r! (n-r)!$, so $\sum |\mathcal{A}_r| r! (n-r)! \leq n!$.
\end{remark}
\subsection{Shadows}
For $\mathcal{A} \subset X^{(r)}$, we know $|\partial A| \geq |A| \frac{r}{n-r+1}$ - but equality is rare (only for $\mathcal{A} = \emptyset$ or $\mathcal{A} = X^{(r)}$).

Given $|\mathcal{A}|$, how should we choose $\mathcal{A} \subset X^{(r)}$ to minimise $|\partial A|$?
(Ultimately, we are asking `how tightly can we pack some $r$-sets?')
If $|\mathcal{A}| = \binom{k}{r}$, it is believable that we'd take $\mathcal{A} = [k]^{(r)}$ - giving $\partial \mathcal{A} = [k]^{(r-1)}$.
What if $\binom{k}{r} < |\mathcal{A}| < \binom{k+1}{r}$? Believable that we'd take $[k]^{(r)}$ and some other $r$-sets from $[k+1]^{(r)}$.
For instance, if $\mathcal{A} \subset X^{(3)}$ with $|\mathcal{A}| = \binom{7}{3} + \binom{4}{2}$, we'd take $\mathcal{A} = [7]^{(3)} \cup \set{A \cup \{8\} | A\in [4]^{(2)}}$

\subsubsection{Two total orderings on \texorpdfstring{$X^{(r)}$}{X(r)}}
Given $A,B \in \hyperlink{def:superr}{X^{(r)}}$, say $A = a_1 \dotsb a_r$, $B = b_1 \dotsb b_r$.
\begin{defi}[Lexicographic order]\index{lexicographic order}\hypertarget{def:lex}
  Say $A < B$ in the \named{lexicographic order} or \textbf{lex order} if for some $i$ we have $a_i < b_i$ and $a_j = b_j \; \forall j < i$.
\end{defi}
Equivalently, $a_i < b_i$, where $i = \min\set{j | a_j \neq b_j}$.
`Use small numbers', dictionary order.

\begin{eg}\leavevmode
  \begin{itemize}
    \item The \hyperlink{def:lex}{lex order} on $\hyperlink{def:ints}{[4]}^{\hyperlink{def:superr}{(2)}}$ is
      \begin{equation*}
        12,13,14,23,24,34.
      \end{equation*}
    \item The lex order on $[6]^{(3)}$ is
      \begin{align*}
        &123,124,125,126,134,135,136,145,146,156,\\
        &234,235,236,245,246,256,345,346,356,456.
      \end{align*}
  \end{itemize}
\end{eg}

\begin{defi}[Colexicographic order]\index{colexicographic order}\hypertarget{def:colex}
  Say $A < B$ in the \named{colexicographic order} or \textbf{colex order} if for some $i$ have $a_i < b_i$ and $a_j = b_j \; \forall j > i$.
\end{defi}
Equivalently, $a_i < b_i$ where $i = \max\set{j | a_j \neq b_j}$.
`Avoid large numbers'. Equivalently, $A < B$ if $\sum_{i \in A} 2^i < \sum_{i \in B} 2^i$.
\begin{eg}\leavevmode
  \begin{itemize}
    \item \hyperlink{def:colex}{Colex} on $\hyperlink{def:ints}{[4]}^{\hyperlink{def:superr}{(2)}}$ is
      \begin{equation*}
        12,13,23,14,24,34
      \end{equation*}
    \item Colex on $[6]^{(3)}$ is
      \begin{align*}
        &123,124,134,234,125,135,235,145,245,345,\\
        &126,136,236,146,246,346,156,256,356,456.
      \end{align*}
  \end{itemize}
\end{eg}
Note: In \hyperlink{def:colex}{colex}, $\hyperlink{def:ints}{[k]}^{\hyperlink{def:superr}{(r)}}$ is an initial segment of $[k+1]^{(r+1)}$, so we could view colex as an enumeration of $\mathbb{N}^{(r)}$ (but this is false for \hyperlink{def:lex}{lex}).

\begin{aim}
  Initial segments of \hyperlink{def:colex}{colex} minimise $\hyperlink{def:shadow}{\partial}$, i.e.\ if $\mathcal{A} \subset \hyperlink{def:superr}{X^{(r)}}$ and $\mathcal{C} \subset X^{(r)}$ is the first $|\mathcal{A}|$ $r$-sets in \hyperlink{def:colex}{colex}, then $|\partial \mathcal{A}| \geq |\partial \mathcal{C}|$.
\end{aim}
This is known as the Kruskal-Katona theorem.
In particular, \begin{equation*}|\mathcal{A}| = \binom{k}{r} \implies |\partial A| \geq \binom{k}{r-1}.\end{equation*}

\subsection{Compressions}
Idea: We want to `replace' $\mathcal{A} \subset X^{(r)}$ with some $\mathcal{A}' \subset X^{(r)}$ such that
\begin{enumerate}[label=(\roman*)]
  \item $|\mathcal{A}'| = |\mathcal{A}|$
  \item $|\hyperlink{def:shadow}{\partial \mathcal{A}'}| \leq |\partial \mathcal{A}|$
  \item $\mathcal{A}'$ `looks more like $\mathcal{C}$' than $\mathcal{A}$ did.
\end{enumerate}
Ideally, we'd compress $\mathcal{A} \to \mathcal{A}' \to \mathcal{A}'' \to \dotsm \to \mathcal{B}$ where either $\mathcal{B} = \mathcal{C}$ or $\mathcal{B}$ is so similar to $\mathcal{C}$ that we can see directly that $|\partial \mathcal{B}| \geq |\partial \mathcal{C}|$.

\marginnote{\emph{Lecture 4}}[0cm]
Use the idea that `\hyperlink{def:colex}{colex} prefers $1$ to $2$' to inspire:
\begin{defi}[$ij$-compression]\index{compression@$ij$-compression}\hypertarget{def:comp}
  For $1 \leq i < j \leq n$, the \textbf{$ij$-compression} $C_{ij}$ defined by: for $A \subset X$,
  \begin{equation*}
    C_{ij}(A) =
    \begin{cases}
      A - \{j\} \cup \{i\} & \text{if } j \in A, i \notin A \\
      A & \text{otherwise}
    \end{cases}
  \end{equation*}
  and for $\mathcal{A} \subset \mathbb{P}(X)$,
  \begin{equation*}
    C_{i,j}(\mathcal{A}) = \set{C_{ij}(A) | A \in \mathcal{A}} \cup \set{A \in \mathcal{A} | C_{ij}(A) \in \mathcal{A}}.
  \end{equation*}

  Say $\mathcal{A}$ is \textbf{$ij$-compressed} if $C_{ij}(\mathcal{A}) = \mathcal{A}$.
\end{defi}
\begin{eg}
  If $\mathcal{A} = \{123,134,234,235,247\}$, then
  \begin{equation*}
    \hyperlink{def:comp}{C_{12}}(\mathcal{A}) = \set{123,134,234,135,147}.
  \end{equation*}
  So $|C_{ij}(\mathcal{A})| = |\mathcal{A}|$.
\end{eg}
\begin{nprop}\label{prop:4}
  Let $\mathcal{A} \subset X^{(r)}$, $1 \leq i < j \leq n$.
  Then
  \begin{equation*}
    |\hyperlink{def:shadow}{\partial} C_{ij}(\mathcal{A})| \leq |\partial \mathcal{A}|.
  \end{equation*}
\end{nprop}
\begin{proof}
  Write $\mathcal{A}'$ for $C_{ij}(\mathcal{A})$.
  We'll show that if $B \in \partial \mathcal{A}' - \partial \mathcal{A}$ then $i \in B, j \notin B$ and $B \cup \{j\} - \{i\} \in \partial \mathcal{A} - \partial \mathcal{A}'$, then done, since this gives an injection.

  We have $B \cup \{x\} \in \mathcal{A}'$, for some $x \notin B$, and $B \cup \{x\} \notin \mathcal{A}$ (as $B \notin \partial \mathcal{A}$).
  Hence $i \in B \cup \{x\}$, $j \notin B \cup \{x\}$ and $(B \cup \{x\}) \cup \{j\} - \{i\} \in \mathcal{A}$.
  Note that $x \neq i$, else $B \cup \{j\} \in \mathcal{A}$, contradicting $B \notin \partial \mathcal{A}$.
  Certainly $B \cup \{j\} - \{i\} \in \partial \mathcal{A}$.

  \textbf{Claim: }$B \cup \{j\} - \{i\} \notin \partial \mathcal{A}'$.

  \textbf{Proof of claim: }Suppose $(B \cup \{j\} - \{i\}) \cup \{y\} \in \mathcal{A}'$.
  We cannot have $y = i$, else $B \cup \{j\} \in \mathcal{A}'$, whence $B \cup \{j\} \in \mathcal{A}$ as $j \in B \cup\{j\}$, a contradiction.

  Thus
  \begin{align*}
    j \in (B \cup \{j\} - \{i\}) \cup \{y\} \\
    i \notin (B \cup \{j\} - \{i\}) \cup \{y\}
    \shortintertext{so}
    (B \cup \{j\} - \{i\}) \cup y \in \mathcal{A}
  \end{align*}
  and $B \cup \{y\} \in \mathcal{A}$ (definition of $C_{ij}$), contradicting the assumption that $B \in \partial \mathcal{A}' - \partial \mathcal{A}$.
\end{proof}

\begin{remark}
  We actually showed
  \begin{equation*}
    \partial C_{ij}(\mathcal{A}) \subset C_{ij}(\partial A).
  \end{equation*}
\end{remark}
\begin{defi}[Left-compressed]\index{compressed}\hypertarget{def:lcomp}
  Say $\mathcal{A} \subset X^{(r)}$ is \textbf{left-compressed} if $C_{ij}(\mathcal{A}) = \mathcal{A} \; \forall i < j$.
\end{defi}
\begin{nprop}\label{prop:5}
  Let $\mathcal{A} \subset X^{(r)}$.
  Then $\exists$ \hyperlink{def:lcomp}{left-compressed} $\mathcal{B} \subset X^{(r)}$ with $|\mathcal{B}| = |\mathcal{A}|$ and $|\hyperlink{def:shadow}{\partial \mathcal{B}}| \leq |\partial \mathcal{A}|$
\end{nprop}
\begin{proof}
  Among all $\mathcal{B} \subset X^{(r)}$ with $|\mathcal{B}| = |\mathcal{A}|$ and $|\hyperlink{def:shadow}{\partial \mathcal{B}}| \leq |\partial \mathcal{A}|$,
  choose one with $\sum_{A \in \mathcal{B}} \sum_{x \in A} x$ minimal.
  Then $\mathcal{B}$ left-compressed, as if $\hyperlink{def:comp}{C_{ij}}(\mathcal{B}) \neq \mathcal{B}$ we contradict minimality.
\end{proof}
\begin{remark}
  Or apply a $\hyperlink{def:comp}{C_{ij}}$, then another, and so on - this must terminate.
  In fact, can apply each $C_{ij}$ at most once, if you chose a sensible order.
\end{remark}

Certainly initial segments of \hyperlink{def:colex}{colex} are \hyperlink{def:lcomp}{left-compressed}.
The converse is false - e.g.\ $\mathcal{A} = \{123,124,125,126,127\}$.

`\hyperlink{def:colex}{Colex} prefers $23$ to $14$' inspires:
\begin{defi}[$UV$-compression]\index{compression@$UV$-compression}\hypertarget{def:uvcomp}
  For $U,V \subset X$ with $|U| = |V|$ and $U \cap V = \emptyset$, the \textbf{$UV$-compression} $C_{UV}$ is defined by
  For $A \subset X$,
  \begin{equation*}
    \begin{cases}
      A \cup U - V & \text{if } V \subset A, U \cap A = \emptyset \\
      A & \text{otherwise}
    \end{cases}
  \end{equation*}
  and if $\mathcal{A} \subset X^{(r)}$,
  \begin{equation*}
    C_{UV}(\mathcal{A}) = \set{C_{UV}(A) | A \in \mathcal{A}} \cup \set{A \in \mathcal{A} | C_{UV}(A) \in \mathcal{A}}
  \end{equation*}

  Say $\mathcal{A}$ is \textbf{$UV$-compressed} if $C_{UV}(\mathcal{A}) = \mathcal{A}$.
\end{defi}

\begin{eg}
  If $\mathcal{A} = \{123,134,235,145,146,157\}$ then
  \begin{equation*}\hyperlink{def:uvcomp}{C_{23,14}}(\mathcal{A}) = \{123,134,235,145,236,157\}.\end{equation*}
\end{eg}
Note that $|C_{UV}(\mathcal{A})| = |\mathcal{A}|$.

Sadly, \hyperlink{def:uvcomp}{$C_{UV}$} need not decrease \hyperlink{def:shadow}{$\partial$} - e.g.\ $\mathcal{A} = \{146,467\}$ has $|\partial\mathcal{A}| = 5$, but $C_{23,14}(\mathcal{A}) = \{236,467\}$ has $|\partial C_{23,14}(\mathcal{A})| = 6$.
$C_{23,14}$ moved some things a long way.
However:
\begin{nprop}\label{prop:6}
  Let $\mathcal{A} \subset \hyperlink{def:superr}{X^{(r)}}$ and $U,V \subseteq X$ with $|U| = |V|$ and $U \cap V = \emptyset$.
  Suppose $\forall x \in U$ $\exists y \in V$ such that $\mathcal{A}$ is \hyperlink{def:uvcomp}{$(U-x, V-y)$-compressed}.
  Then $|\hyperlink{def:shadow}{\partial} \hyperlink{def:uvcomp}{C_{UV}(\mathcal{A})}| \leq |\partial \mathcal{A}|$.
\end{nprop}
\begin{proof}
  \marginnote{\emph{Lecture 5}}[0cm]
  \color{gray}
  Write $\mathcal{A}'$ for $\hyperlink{def:uvcomp}{C_{UV}(\mathcal{A})}$.
  Given $B \in \hyperlink{def:shadow}{\partial} \A' - \partial \A$, we'll show that $U \subset B$, $V \cap B = \emptyset$, and $B \cup V - U \in \partial \A - \partial \A'$ (then done).

  We have $B \cup \{x\} \in \mathcal{A}'$ for some $x \in B$, with $B \cup \{x\} \notin \mathcal{A}$.
  So $U \subset B \cup \{x\}$, $V \cap (B \cup \{x\}) = \emptyset$, and $(B \cup \{x\}) \cup V - U \in \mathcal{A}$.
  Thus certainly $V \cap B = \emptyset$.\bigskip

  If $x \in U$: We have $\mathcal{A}$ is $(U-x,V-y)$-compressed for some $y \in V$.
  So from $(B \cup \{x\}) \cup V - U \in \mathcal{A}$, we obtain $B \cup \{y\} \in \mathcal{A}$,
  contradicting $B \notin \partial \mathcal{A}$.
  Hence $x \notin U$, and so $U \subset B$. \bigskip

  Also, $B \cup V - U \in \partial \mathcal{A}$ (as $(B \cup \{x\}) \cup V - U \in \mathcal{A}$).
  Suppose $B \cup V - U \in \partial \mathcal{A}'$.
  Then $(B \cup V - U) \cup \{w\} \in \mathcal{A}'$ for some $w$.

  If $w \notin U$: Then $V \subset (B \cup V - U) \cup \{w\}$ and $U \cap ((B \cup V - U) \cup \{w\}) = \emptyset$, so from $(B \cup V - U) \cup \{w\} \in \mathcal{A}'$ we can conclude that both $(B \cup V - U) \cup \{w\} \in \mathcal{A}$ and $B \cup \{w\} \in \mathcal{A}$, contradicting $B \notin \partial A.$

  If $w \in U$: We know $\mathcal{A}$ is $(U-w,V-z)$-compressed for some $z \in V$.
  So from $(B \cup V - U) \cup \{w\} \in \mathcal{A}$ (as it is in $\mathcal{A}'$ and contains $V$, so could not have moved).
  We deduce $B \cup \{z\} \in \mathcal{A}$, contradicting $B \notin \partial \mathcal{A}$.
\end{proof}
\begin{remark}
  Actually showed $\partial C_{UV}(\mathcal{A}) \subseteq C_{UV}(\partial\mathcal{A})$.
\end{remark}

\begin{nthm}[Kruskal-Katona Theorem]\label{thm:kk7}\index{Kruskal-Katona theorem}
  Let $\mathcal{A} \subset \hyperlink{def:superr}{X^{(r)}}$ (for $1 \leq r \leq n$) and let $\mathcal{C}$ be the initial segment of \hyperlink{def:colex}{colex} on $X^{(r)}$ with $|\mathcal{C}| = |\mathcal{A}|$.
  Then $|\hyperlink{def:shadow}{\partial \mathcal{A}}| \geq |\partial \mathcal{C}|$.
  In particular, if $|\mathcal{A}| = \binom{k}{r}$ then $|\partial \mathcal{A}| \geq \binom{k}{r-1}$.
\end{nthm}
\begin{proof}
  Let
  \begin{equation*}
    \Gamma = \set{(U,V) | U,V \subset X, |U| = |V| > 0, U \cap V = \emptyset, \max U < \max V}.
  \end{equation*}
  Define a sequence of \hyperlink{def:ss}{set systems} $\mathcal{A}_0, \mathcal{A}_1, \dotsc$ in \hyperlink{def:superr}{$X^{(r)}$} as follows.
  Put $\mathcal{A}_0 = \mathcal{A}$.

  Having defined $\mathcal{A}_k$, if $\mathcal{A}_k$ is \hyperlink{def:uvcomp}{$(U,V)$-compressed} $\forall (U,V) \in \Gamma$ then stop the sequence with $\mathcal{A}_k$.
  If not, choose $(U,V) \in \Gamma$ such that $\mathcal{A}_k$ is not $(U,V)$-compressed with $|U|$ minimal.

  Set $\mathcal{A}_{k+1} = C_{UV}(\mathcal{A}_k)$.
  Note that $\forall x \in U$ we have $(U-\{x\}, V - \{y\}) \in \Gamma \cup \{(\emptyset,\emptyset)\}$ for $y = \min V$.
  So by \cref{prop:6}, $|\partial \mathcal{A}_{n+1}| \leq |\partial \mathcal{A}_n|$.
  Continue.

  The sequence must terminate, e.g.\ as $\sum_{A \in \mathcal{A}_n} \sum_{i \in A} 2^i$ is decreasing in $\mathcal{A}$.
  The final system $\mathcal{B} = \mathcal{A}_k$ satisfies $|\mathcal{B}| = |\mathcal{A}|$ and $|\partial \mathcal{B}| \leq |\partial \mathcal{A}|$, and is $(U,V)$-compressed $\forall (U,V) \in \Gamma$.

  \textbf{Claim:} $\mathcal{B} = \mathcal{C}$.

  \textbf{Proof of claim}: Suppose $\mathcal{B}$ is not an initial segment of colex.
  Then $\exists A < B$ in colex with $A \notin \mathcal{B}$ and $B \in \mathcal{B}$, but then $U = A-B$ and $V = B-A$ have $(U,V) \in \Gamma$ and $C_{UV}(B) = A$, a contradiction.
\end{proof}
\begin{remark}\leavevmode
  \begin{enumerate}
    \item Equivalently: If $\mathcal{A} \subset X^{(r)}$ with
      \begin{equation*}
        |\mathcal{A}| = \binom{k_r}{r} + \binom{k_{r-1}}{r-1} + \dotsb + \binom{k_s}{s},
      \end{equation*}
      where $k_r > k_{r-1} > \dotsb > k_s$ and $s > 0$, then
      \begin{equation*}
        |\partial \mathcal{A}| = \binom{k_r}{r-1} + \binom{k_{r-1}}{r-2} + \dotsb + \binom{k_s}{s-1}.
      \end{equation*}
    \item In the proof of the \nameref{thm:kk7}, we used only \cref{prop:6}, not \cref{prop:4} or \cref{prop:5}.
    \item Uniqueness? Can check that if $|\partial \mathcal{A}| = |\partial \mathcal{C}|$ and $|\mathcal{A}| = \binom{k}{r}$,
      then $\mathcal{A} = Y^{(r)}$, for some $k$-set $Y$ (i.e.\ uniqueness).

      \hypertarget{def:iso}But, in general, it is not true that $|\partial \mathcal{A}| = |\partial \mathcal{C}| \implies \mathcal{A}$ isomorphic to $|\mathcal{C}|$
      (where $\mathcal{A},\mathcal{B}$ are \textbf{isomorphic} if $\exists$ a permutation of $X$ sending $\mathcal{A}$ to $\mathcal{B}$).
  \end{enumerate}
\end{remark}
\begin{defi}[Upper shadow]\hypertarget{def:upshad}
  For $A \subset X^{(r)}$ ($0 \leq r \leq n-1$), the \named{upper shadow} of $\mathcal{A}$ is
  \begin{equation*}
    \partial^+ \mathcal{A} = \set{A \cup \{x\} | A \in \mathcal{A}, x \notin A}.
  \end{equation*}
\end{defi}
Note also $A < B$ in \hyperlink{def:colex}{colex} $\iff$ $A^c < B^c$ in \hyperlink{def:lex}{lex} with ground-set order reversed.

\begin{ncor}\label{cor:8}
  Let $\mathcal{A} \subset \hyperlink{def:superr}{X^{(r)}}$ ($0 \leq r \leq n-1$) and let $\mathcal{C}$ be the initial segment of \hyperlink{def:lex}{lex} with $|\mathcal{C}| = |\mathcal{A}$.
  Then $|\hyperlink{def:upshad}{\partial^+ \mathcal{A}}| \geq |\partial^+ \mathcal{C}|$.
\end{ncor}
\begin{proof}
  Take complements.
\end{proof}
Also, the \hyperlink{def:shadow}{shadow} of an initial segment of \hyperlink{def:colex}{colex} (in \hyperlink{def:superr}{$X^{(r)}$}) is again an initial segment of colex in $X^{(r-1)}$.
Indeed, if
\begin{equation*}\mathcal{C} = \set{A \in X^{(r)} | A \leq a_1 a_2 \dots a_r}\end{equation*}
then
\begin{equation*}\hyperlink{def:shadow}{\partial \mathcal{C}} = \set{B \in X^{(r-1)}| B \leq a_2 \dots a_r}\end{equation*}.

\begin{ncor}\label{cor:9}
  Let $\mathcal{A} \subset \hyperlink{def:superr}{X^{(r)}}$ and let $\mathcal{C} \subset X^{(r)}$ be the initial segment of \hyperlink{def:colex}{colex} with $|\mathcal{C}| = |\mathcal{A}|$.
  Then $|\hyperlink{def:shadow}{\partial}^t \mathcal{A}| \geq |\partial^t \mathcal{C}|$ $\forall 1 \leq t \leq r$.
  In particular, if $|\mathcal{A}| = \binom{k}{r}$ then $|\partial^t \mathcal{A}| \geq \binom{k}{r-t}$.
\end{ncor}
\begin{proof}
  If $|\partial^t \mathcal{A}| \geq |\partial^t \mathcal{C}|$ then $|\partial^{t+1} \mathcal{A}| \geq |\partial^{t+1} \mathcal{C}|$ by \nameref{thm:kk7}.
\end{proof}

\subsection{Intersecting families}
\begin{defi}[Intersecting]\hypertarget{def:inter}
  A \marginnote{\emph{Lecture 6}}[0cm] family $\mathcal{A} \subset \mathbb{P}(X)$ is \named{intersecting} if $A \cap B \neq \emptyset \;\; \forall A, B \in \mathcal{A}$.
\end{defi}
How large can $|\mathcal{A}|$ be?
Can achieve $|\mathcal{A}| = 2^{n-1}$, by taking, e.g.\ $\mathcal{A} = \set{A \subset X | 1 \in A}$.
\begin{nprop}\label{prop:10}
  Let $\mathcal{A} \subset \mathbb{P}(X)$ be \hyperlink{def:inter}{intersecting}.
  Then $|\A| \leq 2^{n-1}$.
\end{nprop}
\begin{proof}
  For each $A \subset X$, can have $\leq 1$ of $A, A^c$ in $\mathcal{A}$.
\end{proof}
Note: there are many examples with $|\A| = 2^{n-1}$, e.g.\ for $n$ odd we can take \begin{equation*}\Set{A \subset X |\ |A| > \frac{n}{2}}.\end{equation*}
% top of cube
\begin{center}
  \begin{tikzpicture}
    \draw [red, dashed] (0,1.65) circle [x radius=2.4cm, y radius=1.7cm];
    \begin{scope}
      \draw (0,3.2) circle [x radius=1mm, y radius=0.8mm];
      \node [right] at (0.25, 3.2) {$X^{(n)}$};

      \draw (0,2.8) circle [x radius=4.5mm, y radius=1.5mm];
      \node [right] at (0.5, 2.8) {$X^{(n-1)}$};

      \draw (0,2.1) circle [x radius=9mm, y radius=3mm];
      \node [right] at (0.9, 2.1) {$X^{(n-2)}$};

      \node at (0,1.55) {$\vdots$};

      \draw (0,0.6) circle [x radius=16mm, y radius=5mm];
      \node [right] at (1.6, 0.6) {$X^{(\ceil{\frac{n}{2}})}$};

      \draw (0,-0.6) circle [x radius=16mm, y radius=5mm];
      \node [right] at (1.6, -0.6) {$X^{(\floor{\frac{n}{2}})}$};

      \node at (0,-1.35) {$\vdots$};

      \draw (0,-2.1) circle [x radius=9mm, y radius=3mm];
      \node [right] at (0.9, -2.1) {$X^{(2)}$};

      \draw (0,-2.8) circle [x radius=4.5mm, y radius=1.5mm];
      \node [right] at (0.5, -2.8) {$X^{(1)}$};

      \draw (0,-3.2) circle [x radius=1mm, y radius=0.8mm];
      \node [right] at (0.25, -3.2) {$X^{(0)}$};
    \end{scope}
  \end{tikzpicture}
\end{center}
What if we insist $A \subset X^{(r)}$?

If $r > \frac{n}{2}$, this is a silly question, as we can take $\A = X^{(r)}$.
If $r = \frac{n}{2}$, the maximum is $\frac{1}{2} \binom nr$ - just choose one of $A,A^c$ for each $A \in X^{(r)}$.
So assume $r < \frac{n}{2}$.

Taking $\mathcal{A} = \set{A \in X^{(r)} | 1 \in A}$ gives $|\A| = \binom{n-1}{r-1} = \frac{r}{n} \binom nr$.

Could also try, e.g.\ $\mathcal{B} = \set{A \in X^{(r)} | |A \cap \{1,2,3\}| \geq 2}$.

Try both on $[8]^{(3)}$:
\begin{gather*}
  |\A| = \binom{7}{2} = 21 \\
  |\mathcal{B}| = 1 + \binom{3}{2} \binom{5}{1} = 16 < 21.
\end{gather*}
where the first term counts the number of $|A \cap \{1,2,3\}| = 3$, and the second term counts $|A \cap \{1,2,3\}| = 2$.

In fact, the size from $\A$ is optimal:
\begin{nthm}[Erd\H{o}s-Ko-Rado]\label{thm:ekr11}\index{Erd\H{o}s-Ko-Rado theorem}
  Let $r < \frac{n}{2}$, and let $\A \subset X^{(r)}$ be \hyperlink{def:inter}{intersecting}.
  Then $|\A| \leq \binom{n-1}{r-1}$.
\end{nthm}
\begin{proof}[Proof 1: `Bubble down with \nameref{thm:kk7}']
  For $A,B \in \A$, have $A \cap B \neq 0$, i.e.\ $A \nsubseteq B^c$.
  Writing $\bar{\A}$ for $\set{A^c | A \in \A} \subset X^{(n-r)}$, this says that $\partial^{n-2r} \bar{\A}$ is disjoint from $\A$.

  Suppose $|\A| > \binom{n-1}{r-1}$.
  Then $|\A^c| > \binom{n-1}{r-1} = \binom{n-1}{n-r}$, so by \nameref{thm:kk7} (as given in \cref{cor:9}), have $|\partial^{n-2r} \bar{\A}| \geq \binom{n-1}{r}$.
  But
  \begin{equation*}
    \binom{n-1}{r-1} + \binom{n-1}{r} = \binom{n}{r}
  \end{equation*}
  i.e.\
  \begin{equation*}
    |\partial^{n-2r} \bar{\A}| + |\A| > |X^{(r)}|.
  \end{equation*}
  a contradiction.
\end{proof}
\begin{remark}
  The numbers \emph{had} to work, as we get equality for $\A = \set{A \in X^{(r)} | 1 \in A}$.
\end{remark}
\begin{proof}[Proof 2]
  Consider a cyclic ordering of $[n]$, i.e.\ a bijection $C: [n] \to \mathbb{Z}_n$, e.g.
  \begin{center}
    \begin{tikzpicture}[scale=1.5]
      \draw (0,0) circle [radius = 1cm];
      \begin{scope}[every node/.style={fill=white, circle, inner sep=0.3mm}]
      \node at (90:1) {1};
      \node at (45:1) {4};
      \node at (0:1) {3};
      \node at (-45:1) {2};
      \node at (-90:1) {8};
      \node at (-135:1) {6};
      \node at (180:1) {5};
      \node at (135:1) {7};
      \end{scope}
    \end{tikzpicture}
  \end{center}
  How many $A \in \A$ are intervals (sets of $r$ consecutive elements) in our ordering?
  Answer: $\leq r$. Indeed, suppose $c_1 \dots c_r \in \mathcal{A}$.
  Then, for each $1 \leq i \leq r-1$, at most one of the two intervals $\dots c_{i-1} c_i$ and $c_{i+1} c_{i+2} \dots$ can belong to $\A$.

  Also, a given $r$-set $A$ is an interval in exactly $n r! (n-r)!$ of the $n!$ cyclic orderings.
  Hence $|\A| n r! (n-r)! \leq n! r$, i.e.
  \begin{equation*}
    |\A| \leq \frac{(n-1)!}{(r-1)! (n-r)!} = \binom{n-1}{r-1}. \qedhere
  \end{equation*}
\end{proof}
\begin{remark}\leavevmode
  \begin{enumerate}
    \item Equivalently, we are double-counting the edges in the bipartite graph, vertex classes $\A$ and all cyclic orderings, in which $A$ is joined to $C$ if $A$ is an interval in $C$.
    \item This method is called \named{averaging}, or Katona's method.
  \end{enumerate}
\end{remark}
Equality in \nameref{thm:ekr11}? Can check equality holds $\iff \A = \set{A \in X^{(r)} | i \in A}$ for some $i$.
This follows (proof 1) from equality case of \nameref{thm:kk7}, or (proof 2) by considering changing the cyclic ordering bit by bit.
\clearpage
\section{Isoperimetric inequalities}
`How tightly can we pack a subset of given size in a space?'
\marginnote{\emph{Lecture 7}}[0cm]We are familiar with this kind of inequality in the continuous sense:
\begin{itemize}
  \item Among subsets of $\mathbb{R}^2$ of given area, the disc has smallest perimeter.
  \item Among subsets of $\mathbb{R}^3$ of given volume, the disc has smallest surface area.
  \item Among subsets of $S^2$ of given area, the cap has smallest perimeter.
\end{itemize}

\begin{center}
  \begin{tikzpicture}
    \begin{scope}
      \draw [fill=bred!20] (0,0) circle [radius=1cm];
    \end{scope}
    \begin{scope}[xshift=3cm]
      \shade [ball color = bred!40, opacity = 0.6] (0,0) circle (1cm);
      \draw (0,0) circle (1cm);
      \draw (-1,0) arc (180:360:1 and 0.3);
      \draw [dashed] (1,0) arc (0:180:1 and 0.3);
    \end{scope}
    \begin{scope}[xshift=6cm]
    \end{scope}
  \end{tikzpicture}
\end{center}

\begin{defi}[Boundary]
For a set $A$ of vertices in a graph $G$, the \named{boundary} is
\begin{equation*}
  b(A) = \set{x \in V(G) | x \notin A, xy \in E \text{ for some } y \in A}.
\end{equation*}
\end{defi}
For example, in the picture, if $A = \{1,2,3\}$, then $b(A) = \{4,5\}$.

An \named{isoperimetric inequality} on $G$ is an inequality of the form
\begin{equation*}
  |b(A)| \geq f(|A|) \quad \forall \subseteq V(G).
\end{equation*}

Equivalently, minimise the \named{neighbourhood} of $A$:
\begin{equation*}
  N(A) = A \cap b(A) = \set{x \in G | d(x,A) \leq 1}
\end{equation*}
where $d$ denotes the usual graph distance.

A natural guess is often $B(x,r) = \set{y \in G | d(x,y) \leq r}$.

What happens in $Q_n$?
For example, try $|A|=4$ in $Q_3$:
\begin{center}
  \begin{tikzpicture}[scale=2]
    \node at (0.65,-0.3) {$|b(A)| = 3$};
    \begin{scope}[every node/.style={draw=black, inner sep=1.5pt, circle}]
      \node [fill=bred  ] (A) at (0,0) {};
      \node [fill=bred  ] (B) at (1,0) {};
      \node [fill=bgreen] (C) at (1,1) {};
      \node [fill=bred  ] (D) at (0,1) {};
      \node [fill=bred  ] (E) at (0.3,0.4) {};
      \node [fill=bgreen] (F) at (1.3,0.4) {};
      \node               (G) at (1.3,1.4) {};
      \node [fill=bgreen] (H) at (0.3,1.4) {};
      \draw (A) -- (B) -- (C) -- (D) -- (A);
      \draw (E) -- (F) -- (G) -- (H) -- (E);
      \draw (A) -- (E);
      \draw (B) -- (F);
      \draw (C) -- (G);
      \draw (D) -- (H);

      \begin{scope}[xshift=3cm]
        \node [fill=bred  ] (A) at (0,0) {};
        \node [fill=bred  ] (B) at (1,0) {};
        \node [fill=bgreen] (C) at (1,1) {};
        \node [fill=bgreen] (D) at (0,1) {};
        \node [fill=bred  ] (E) at (0.3,0.4) {};
        \node [fill=bred  ] (F) at (1.3,0.4) {};
        \node [fill=bgreen] (G) at (1.3,1.4) {};
        \node [fill=bgreen] (H) at (0.3,1.4) {};
        \draw (A) -- (B) -- (C) -- (D) -- (A);
        \draw (E) -- (F) -- (G) -- (H) -- (E);
        \draw (A) -- (E);
        \draw (B) -- (F);
        \draw (C) -- (G);
        \draw (D) -- (H);
      \end{scope}
  \end{scope}
  \end{tikzpicture}
\end{center}

Guess: `Balls are best', i.e.\ if $|A| = |X^{(\leq r)}|$, then $|N(A)| \geq |X^{(\leq r + 1)}|$ (where $X^{(\leq r)}$ is shorthand for $X^{(0)} \cup \dotsb \cup X^{(r)}$).
What if $|A|$ strictly between $\sum_{i=0}^r \binom{n}{i}$ and $\sum_{i=0}^{r+1} \binom{n}{i}$?

Guess: Take $A = X^{(\leq r)} \cup B$, for some $B \subset X^{(r+1)}$ (called a `Hamming Ball'\index{Hamming ball}).

If we knew this, then $N(A) = X^{(\leq r+1)} \cup \partial^+ B$, so by \nameref{thm:kk7}, we'd take $B$ to be an initial segment of \hyperlink{def:lex}{lex}.

\begin{defi}[Simplicial order]\hypertarget{def:simplicial}
  Define the \named{simplicial order} on $Q_n$ by $x<y$ if either $|x| < |y|$ or $|x|=|y|$ and $x<y$ in \hyperlink{def:lex}{lex}.
\end{defi}
`Go up in levels, and use lex inside a level.'
Aim: Initial segments of \hyperlink{def:simplicial}{simplicial} order are best.

\begin{defi}[Sections]
  Given $A \subset \hyperlink{def:qn}{Q_n}$ and $1 \leq i \leq n$, the \named{section}\textbf{$i$-sections} are the \hyperlink{def:ss}{set systems} $A_+^{(i)}, A_-^{(i)} \subset \mathcal{P}(X-i)$ given by
  \begin{align*}
    A_-^{(i)} = \set{ x \in A | i \notin x} \subset \mathcal{P}(X-i)
    A_+^{(i)} = \set{ x - \{i\} | x \in A, i \in x} \subset \mathcal{P}(X-i)
  \end{align*}
\end{defi}
\begin{defi}[Compression]\hypertarget{def:icomp}
  Define the \textbf{$i$-compression} $C_i(A)$ of $A$ by giving its $i$-sections.
  \begin{itemize}
    \item $C_i(A)_+^{i}$ is the initial segment of $Q_{n-1}$ of size $|A^{(i)}_+|$
    \item $C_i(A)_-^{i}$ is the initial segment of $Q_{n-1}$ of size $|A^{(i)}_-|$
  \end{itemize}
\end{defi}
Certainly $|\hyperlink{def:icomp}{C_i(A)}| = |A|$.
Also, $C_i(A)$ `looks more like' an initial segment of \hyperlink{def:simplicial}{simplicial} than $A$ did.

Say $A$ is \textbf{$i$-compressed} if $\hyperlink{def:icomp}{C_i(A)} = A$.

\begin{nthm}[Harper's theorem]\label{thm:harper1}
  Let $A \subset Q_n$, and let $C$ be the initial segment of simplicial order with $|C| = |A|$.
  Then $|N(A)| \geq |N(C)|$. In particular, if $|A| \geq \sum_{i=0}^r \binom{n}{i}$ then $|N(A)| \geq \sum_{i=0}^{r+1} \binom{n}{i}$.
\end{nthm}
\begin{remark}\leavevmode
  \begin{enumerate}[label=\arabic*.]
    \item If we know $A$ is a \hyperlink{def:hamming}{Hamming ball}, then done by \nameref{thm:kk7}.
    \item \nameref{thm:harper1} $\implies$ \nameref{thm:kk7}. Indeed, given $B \subset X^{(r)}$.
      Apply \nameref{thm:harper1} to $A = B \cup X^{(\leq r-1)}$
  \end{enumerate}
\end{remark}
\begin{proof}
  Induction on $n$. $n=1$ works.
  Given $A \subset Q_n$ for $n > 1$, fix $1 \leq i \leq n$.

  \textbf{Claim:} $|N(C_i(A))| \leq |N(A)|$.

  \textbf{Proof of claim:} Write $B = C_i(A)$.
  We have
  \begin{align*}
    |N(A)| &= |A_+ \cup N(A_-)| + |A_- \cup N(A_+)| \\
    |N(B)| &= |B_+ \cup N(B_-)| + |B_- \cup N(B_+)|
  \end{align*}
  where the first term is `downstairs', and the second term is `upstairs'.
  Now, $|B_+| = |A_+|$ and $|N(B_-)| \leq |N(A_-)|$ by induction.

  But $N(B_-)$ is an initial segment of \hyperlink{def:simplicial}{simplicial} on $Q_{n-1}$ as is $B_+$.

  So $N(B_-)$ and $B_+$ are nested.
  Hence
  \begin{align*}
    |B_+ \cup N(B_-)| &\leq |A_+ \cup N(A_-)| \\
    |B_- \cup N(B_+)| &\leq |A_- \cup N(A_+)|
  \end{align*}
  Thus $|N(B)| \leq |N(A)|$.
\end{proof}
\marginnote{\emph{Lecture 8}}[0cm]Among all $B \subset Q_n$ with $|B| = |A|$ and $|N(B)| \leq |N(A)|$, choose one with
\begin{equation*}
  \sum_{x \in B} f(x)
\end{equation*}
minimal, where $f(x)=$ the position of $x$ in the \hyperlink{def:simplicial}{simplicial order} on $Q_n$.
Then $B$ is $i$-compressed $\forall i$.

Must such a $B$ be an initial segment of simplicial?
Unfortunately, no - e.g.\ $A = \{\emptyset,1,2,12\} \subset Q_3$.

However,
\begin{nlemma}\label{lem:2.2}
  Let $B \subset Q_n$ be $i$-compressed $\forall i$ but not an initial segment of the simplicial order.
  Then if $n$ is odd, say $n = 2k+1$, we have
  \begin{equation*}
    B = X^{(\leq k)} - \{\text{last $k$-set}\} \cup \{\text{first $k$-set}\}, % mark the last kset as (k+2),...,(2k+1) and the first as 1,2,...,k,(k+1)
  \end{equation*}
  while if $n$ is even, say $n = 2k$, we have
  \begin{equation*}
    B = X^{(\leq k-1)} \cup \set{x \in X^{(k)} | 1 \in x} - \{\text{last $k$-set with 1}\} \cup \{\text{first $k$-set without $1$}\}. % mark the last kset as 1(k+2),...,(2k) and the first as 2,3,4,...,k,(k+1)
  \end{equation*}
\end{nlemma}
Once we have proved this, we are done, as in each case $|N(B)| \geq |N(C)|$.
\begin{proof}
  We have $x \notin B, y \in B$ for some $x,y$ with $x<y$ in simplicial.
  We cannot have $i \in x, i \in y$ (as $B$ is $i$-compressed), and cannot have $i \notin x, i \notin y$ (as $B$ is $i$-compressed).

  So, for each $i$, $i$ belongs to exactly one of $x,y$.
  Thus $y = x^c$.

  Hence for each $y \in B$, at most one $x < y$ has $x \notin B$ (namely $Y^c$) and for each $x \notin B$, at most $y > x$ has $y \in B$ (namely $X^c$).

  Hence $B = \set{z | z \leq y} - \{x\}$ where $x$ is the immediate predecessor of $y$ and $x = y^c$.
  But then $x=$ last $k$-set (if $n=2k+1$) or the last $k$-set containing $1$ (if $n = 2k$)
  by definition of simplicial ordering.
\end{proof}

\begin{remark}\leavevmode
  \begin{enumerate}[label=\arabic*.]
    \item Can also prove \nameref{thm:harper1} by $UV$-compressions.
    \item Can also use these `codimension 1' compressions to prove \nameref{thm:kk7}.
  \end{enumerate}
\end{remark}
\begin{defi}
  For $A \subset Q_i$, the \textbf{$t$-neighbourhood} of $A$ is
  \begin{equation*}
    A_{(t)} \coloneqq N^t(A) = \set{x \in Q_n | d(x,A) \leq t}.
  \end{equation*}
\end{defi}
\begin{ncor}\label{cor:3}
  Let $A \subset Q_n$ with $|A| = |X^{(\leq r)}|$. Then, for $1 \leq t \leq n-r$, have
  \begin{equation*}
    |A_{(t)}| \geq |X^{(\leq r + t)}
  \end{equation*}
\end{ncor}
\begin{proof}
  \cref{thm:harper1} and induction.
\end{proof}
To get a feel for what \cref{cor:3} is saying, we'll need some estimates for things like $\sum_{i=0}^r \binom{n}{i}$.
\begin{nprop}\label{prop:2.4}
  Let $0 \leq \epsilon < \frac{1}{4}$.
  \begin{equation*}
    \sum_{i=0}^\floor{(\frac{1}{2} - \epsilon) n} \binom{n}{i} < \frac{1}{\epsilon} e^{(-\epsilon^2 \frac{n}{2})} 2^n
  \end{equation*}
  (an exponentially small fraction of $2^n$ for $\epsilon$ fixed).
\end{nprop}
Roughly we are going around $\epsilon \sqrt{n}$ standard deviations from the mean.

\begin{proof}
  For $i \leq (\frac{1}{2} - \epsilon) n:$
  \begin{equation*}
    \frac{\binom{n}{n-i}}{\binom{n}{i}} = \frac{i}{n-i+1} \leq \frac{\frac{1}{2} - \epsilon}{\frac{1}{2} + \epsilon} = 1 - \frac{2\epsilon}{\frac{1}{2} + \epsilon} \leq 1 - 2\epsilon.
  \end{equation*}
  Hence
  \begin{equation*}
    \sum_{i=0}^{\floor{(\frac{1}{2}-\epsilon) n}} \binom{n}{i} \leq \frac{1}{2\epsilon} \binom{n}{\floor{(\frac{1}{2} + \epsilon) n}}
  \end{equation*}
  as a geometric progression.
  Similarly, replacing $\epsilon$ with $\epsilon/2$,
  \begin{align*}
    \binom{n}{\floor{(\frac{1}{2} - \epsilon)n}} &\leq (1-\epsilon)^{\epsilon \frac{n}{2} - 1} \binom{n}{\floor{(\frac{1}{2} - \frac{\epsilon}{2}) n}} \\
                                                 &\leq 2(1-\epsilon)^{\epsilon/2} 2^n \\
                                                 &\leq 2 e^{-\epsilon \cdot \epsilon n/2} 2^n,
  \end{align*}
  using $e^{-x} \geq 1-x$ in the final step.
  Thus
  \begin{equation*}
    \sum_{i=0}^{\floor{(\frac{1}{2} - \epsilon) n}} \leq \frac{1}{2\epsilon} 2 e^{-\epsilon^2 n / 2} 2^n. \qedhere
  \end{equation*}
\end{proof}
\clearpage
\section{Projections}
\printindex
\end{document}
